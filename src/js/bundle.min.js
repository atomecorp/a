var SquirrelApp=function(){"use strict";window.Slider=class{constructor(t){this.originalConfig=t||{},this.config={attach:"body",id:"slider_"+Math.random().toString(36).substr(2,9),x:20,y:20,width:300,height:60,trackWidth:300,trackHeight:8,thumbSize:24,min:0,max:100,step:1,value:50,type:"horizontal",grip:{width:null,height:null,backgroundColor:"#2196f3",border:"3px solid #ffffff",borderRadius:"50%",boxShadow:"0 4px 12px rgba(33, 150, 243, 0.4)",cursor:"pointer",transition:"transform 0.2s ease-out, box-shadow 0.2s ease-out"},support:{backgroundColor:"#ffffff",border:"1px solid rgba(0,0,0,0.04)",borderRadius:"12px",boxShadow:"0 8px 32px rgba(0,0,0,0.12), 0 2px 6px rgba(0,0,0,0.08)",padding:"15px"},rail:{backgroundColor:"#e0e0e0",borderRadius:"3px",height:null,width:null},progress:{backgroundColor:"#2196f3",borderRadius:"3px",boxShadow:"0 2px 4px rgba(33, 150, 243, 0.3)",transition:"width 0.2s ease-out, height 0.2s ease-out"},colors:{container:"#ffffff",track:"#e0e0e0",progress:"#2196f3",thumb:"#2196f3"},animations:{enabled:!0,duration:.2,easing:"ease-out"},callbacks:{onChange:null,onStart:null,onEnd:null,onDrag:null},theme:"material",variation:null,circular:{radius:80,strokeWidth:8,startAngle:0,endAngle:270},...t},this.currentValue=this.config.value,this.isDragging=!1,this.elements={},this._mergeStyleAPIs(),this._init()}_mergeStyleAPIs(){if(this.config.colors&&(this.config.colors.container&&!this.originalConfig.support?.backgroundColor&&(this.config.support.backgroundColor=this.config.colors.container),this.config.colors.track&&!this.originalConfig.rail?.backgroundColor&&(this.config.rail.backgroundColor=this.config.colors.track),this.config.colors.progress&&!this.originalConfig.progress?.backgroundColor&&(this.config.progress.backgroundColor=this.config.colors.progress),this.config.colors.thumb&&!this.originalConfig.grip?.backgroundColor&&(this.config.grip.backgroundColor=this.config.colors.thumb,!this.originalConfig.grip?.boxShadow))){const t=this.config.colors.thumb;this.config.grip.boxShadow=`0 4px 12px ${this._addAlphaToColor(t,.4)}`}null===this.config.grip.width&&(this.config.grip.width=this.config.thumbSize),null===this.config.grip.height&&(this.config.grip.height=this.config.thumbSize),null===this.config.rail.height&&(this.config.rail.height=this.config.trackHeight),null===this.config.rail.width&&(this.config.rail.width=this.config.trackWidth)}_init(){"circular"===this.config.type?(this._createCircularSlider(),this._attachCircularEvents()):(this._createLinearSlider(),this._attachEvents()),this._applyStyles(),this.setValue(this.config.value)}_createLinearSlider(){"vertical"===this.config.type?(this.originalConfig.hasOwnProperty("trackWidth")||(this.config.trackWidth=8),this.originalConfig.hasOwnProperty("trackHeight")||(this.config.trackHeight=Math.max(100,this.config.height-40))):(this.originalConfig.hasOwnProperty("trackWidth")||(this.config.trackWidth=Math.max(100,this.config.width-40)),this.originalConfig.hasOwnProperty("trackHeight")||(this.config.trackHeight=8)),this._createContainer(),this._createTrack(),this._createProgress(),this._createThumb()}_createCircularSlider(){this._createCircularContainer(),this._createCircularTrack(),this._createCircularProgress(),this._createCircularThumb()}_createContainer(){this.config.type,this.elements.container=new A({attach:this.config.attach,id:this.config.id+"_container",markup:"div",role:"slider-container",x:this.config.x,y:this.config.y,width:this.config.width,height:this.config.height,backgroundColor:"#ffffff",border:this.config.support.border,smooth:this.config.support.borderRadius?parseInt(this.config.support.borderRadius):12,padding:this.config.support.padding?parseInt(this.config.support.padding):15,boxShadow:this.config.support.boxShadow,overflow:"visible"});const t=()=>{this.elements.container&&this.elements.container.html_object?(this.elements.container.html_object.style.background=this.config.support.backgroundColor,this.elements.container.html_object.style.backgroundImage=this.config.support.backgroundColor.includes("gradient")?this.config.support.backgroundColor:""):setTimeout(t,10)};setTimeout(t,50)}_createTrack(){this.config.type;const t=2*(this.config.support.padding?parseInt(this.config.support.padding):15),i=this.config.width-t,e=this.config.height-t;this.elements.track=new A({attach:`#${this.config.id}_container`,id:this.config.id+"_track",markup:"div",x:(i-this.config.trackWidth)/2,y:(e-this.config.trackHeight)/2,width:this.config.trackWidth,height:this.config.trackHeight,backgroundColor:this.config.rail.backgroundColor,smooth:this.config.rail.borderRadius?parseInt(this.config.rail.borderRadius):3,position:"relative",cursor:"pointer"})}_createProgress(){const t="vertical"===this.config.type,i=this.currentValue/(this.config.max-this.config.min)*(t?this.config.trackHeight:this.config.trackWidth);this.elements.progress=new A({attach:`#${this.config.id}_track`,id:this.config.id+"_progress",markup:"div",x:0,y:t?this.config.trackHeight-i:0,width:t?this.config.trackWidth:i,height:t?i:this.config.trackHeight,backgroundColor:"#ffffff",smooth:this.config.progress.borderRadius?parseInt(this.config.progress.borderRadius):3,position:"absolute",transition:this.config.animations.enabled?this.config.progress.transition||`${t?"height":"width"} ${this.config.animations.duration}s ${this.config.animations.easing}`:"none",boxShadow:this.config.progress.boxShadow});const e=()=>{this.elements.progress&&this.elements.progress.html_object?(this.elements.progress.html_object.style.background=this.config.progress.backgroundColor,this.elements.progress.html_object.style.backgroundImage=this.config.progress.backgroundColor.includes("gradient")?this.config.progress.backgroundColor:""):setTimeout(e,10)};setTimeout(e,50)}_createThumb(){const t="vertical"===this.config.type,i=t?this.config.trackHeight:this.config.trackWidth,e=this.currentValue/(this.config.max-this.config.min)*i;this.elements.thumb=new A({attach:`#${this.config.id}_track`,id:this.config.id+"_thumb",markup:"div",x:t?(this.config.trackWidth-this.config.grip.width)/2:e-this.config.grip.width/2,y:t?this.config.trackHeight-e-this.config.grip.height/2:(this.config.trackHeight-this.config.grip.height)/2,width:this.config.grip.width,height:this.config.grip.height,backgroundColor:this.config.grip.backgroundColor,smooth:this.config.grip.borderRadius||"50%",position:"absolute",cursor:this.config.grip.cursor,transition:this.config.animations.enabled?this.config.grip.transition||`transform ${this.config.animations.duration}s ${this.config.animations.easing}, box-shadow ${this.config.animations.duration}s ${this.config.animations.easing}`:"none",boxShadow:this.config.grip.boxShadow,border:this.config.grip.border})}_applyStyles(){if(this._applyTheme(),this._applySupportStyles(),this._applyRailStyles(),this._applyProgressStyles(),this._applyGripStyles(),!document.getElementById("slider-animations")){const t=document.createElement("style");t.id="slider-animations",t.textContent="\n                @keyframes ripple {\n                    to {\n                        transform: translate(-50%, -50%) scale(4);\n                        opacity: 0;\n                    }\n                }\n                \n                .slider-thumb:focus {\n                    outline: 2px solid #2196f3;\n                    outline-offset: 2px;\n                }\n            ",document.head.appendChild(t)}}_updateVariationColors(t){if(!this.config.variation||!Array.isArray(this.config.variation)){const i=120*t,e=`hsl(${i}, 70%, 50%)`;return this.elements.progress.html_object.style.backgroundColor=e,this.elements.thumb.html_object.style.backgroundColor=e,void(this.elements.thumb.html_object.style.boxShadow=`0 4px 12px hsla(${i}, 70%, 50%, 0.4)`)}const i=this.config.variation;if(0===i.length)return;if(1===i.length){const t=i[0].color;return this.elements.progress.html_object.style.backgroundColor=t,void(this.elements.thumb.html_object.style.backgroundColor=t)}let e=i[0],s=i[i.length-1];for(let o=0;o<i.length-1;o++){const n=this._parsePosition(i[o].position)/100,r=this._parsePosition(i[o+1].position)/100;if(t>=n&&t<=r){e=i[o],s=i[o+1];break}}const o=this._parsePosition(e.position)/100,n=this._parsePosition(s.position)/100,r=o===n?0:(t-o)/(n-o),a=this._interpolateColors(e.color,s.color,r);this.elements.progress.html_object.style.backgroundColor=a,this.elements.thumb.html_object.style.backgroundColor=a;const h=this._addAlphaToColor(a,.4);this.elements.thumb.html_object.style.boxShadow=`0 4px 12px ${h}`}_parsePosition(t){return"string"==typeof t?parseFloat(t.replace("%","")):"object"==typeof t&&t.x?parseFloat(t.x.replace("%","")):0}_interpolateColors(t,i,e){const s=this._hexToRgb(t),o=this._hexToRgb(i);if(!s||!o)return t;return`rgb(${Math.round(s.r+e*(o.r-s.r))}, ${Math.round(s.g+e*(o.g-s.g))}, ${Math.round(s.b+e*(o.b-s.b))})`}_hexToRgb(t){if(t.startsWith("#")){const i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}const i=document.createElement("div");i.style.color=t,document.body.appendChild(i);const e=window.getComputedStyle(i).color;document.body.removeChild(i);const s=e.match(/\d+/g);return s?{r:parseInt(s[0]),g:parseInt(s[1]),b:parseInt(s[2])}:null}_addAlphaToColor(t,i){return t.startsWith("rgb(")?t.replace("rgb(","rgba(").replace(")",`, ${i})`):t}_applyTheme(){const t={material:{containerShadow:"0 8px 32px rgba(0,0,0,0.12), 0 2px 6px rgba(0,0,0,0.08)",thumbShadow:"0 4px 12px rgba(33, 150, 243, 0.4)",borderRadius:"12px"},flat:{containerShadow:"none",thumbShadow:"none",borderRadius:"0px"},custom:{}},i=t[this.config.theme]||t.material;i.containerShadow&&(this.elements.container.html_object.style.boxShadow=i.containerShadow),i.thumbShadow&&this.elements.thumb&&(this.elements.thumb.html_object.style.boxShadow=i.thumbShadow),i.borderRadius&&(this.elements.container.html_object.style.borderRadius=i.borderRadius)}_attachEvents(){this._attachHoverEvents(),this._attachClickEvents(),this._attachDragEvents(),this._attachKeyboardEvents()}_attachCircularEvents(){this._attachCircularHoverEvents(),this._attachCircularKeyboardEvents()}_attachCircularHoverEvents(){this.elements.thumb&&(this.elements.thumb.html_object.addEventListener("mouseenter",(()=>{this.isDragging||(this.elements.thumb.html_object.style.transform="scale(1.2)")})),this.elements.thumb.html_object.addEventListener("mouseleave",(()=>{this.isDragging||(this.elements.thumb.html_object.style.transform="scale(1)")})))}_attachCircularKeyboardEvents(){this.elements.thumb&&(this.elements.thumb.html_object.setAttribute("tabindex","0"),this.elements.thumb.html_object.classList.add("slider-thumb"),this.elements.thumb.html_object.addEventListener("keydown",(t=>{let i=this.currentValue;switch(t.key){case"ArrowLeft":case"ArrowDown":i-=this.config.step;break;case"ArrowRight":case"ArrowUp":i+=this.config.step;break;case"Home":i=this.config.min;break;case"End":i=this.config.max;break;default:return}this.setValue(i),this._triggerCallback("onChange",i),t.preventDefault()})))}_attachHoverEvents(){this.elements.thumb.html_object.addEventListener("mouseenter",(()=>{this.isDragging||(this.elements.thumb.html_object.style.transform="scale(1.2)")})),this.elements.thumb.html_object.addEventListener("mouseleave",(()=>{this.isDragging||(this.elements.thumb.html_object.style.transform="scale(1)")}))}_attachClickEvents(){"circular"!==this.config.type&&this.elements.track.html_object.addEventListener("click",(t=>{if(!this.isDragging){const i=this._getValueFromEvent(t);this.setValue(i),this._createRipple(t),this._triggerCallback("onChange",i)}}))}_attachDragEvents(){this.elements.thumb.html_object.addEventListener("mousedown",(t=>{this._startDrag(t)}))}_attachKeyboardEvents(){this.elements.thumb.html_object.setAttribute("tabindex","0"),this.elements.thumb.html_object.classList.add("slider-thumb"),this.elements.thumb.html_object.addEventListener("keydown",(t=>{let i=this.currentValue;switch(t.key){case"ArrowLeft":case"ArrowDown":i-=this.config.step;break;case"ArrowRight":case"ArrowUp":i+=this.config.step;break;case"Home":i=this.config.min;break;case"End":i=this.config.max;break;default:return}this.setValue(i),this._triggerCallback("onChange",i),t.preventDefault()}))}_startDrag(t){this.isDragging=!0,this.elements.thumb.html_object.style.transform="scale(1.3)",this.elements.thumb.html_object.style.zIndex="1000",document.body.style.userSelect="none",this.elements.progress.html_object.style.transition="none",this._triggerCallback("onStart",this.currentValue);const i=t=>{if(this.isDragging){const i=this._getValueFromEvent(t);this.setValue(i),this._triggerCallback("onChange",i)}},e=()=>{if(this.isDragging=!1,this.elements.thumb.html_object.style.transform="scale(1)",this.elements.thumb.html_object.style.zIndex="",document.body.style.userSelect="",this.config.animations.enabled){const t="vertical"===this.config.type;this.elements.progress.html_object.style.transition=`${t?"height":"width"} ${this.config.animations.duration}s ${this.config.animations.easing}`}this._triggerCallback("onEnd",this.currentValue),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",e)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",e),t.preventDefault()}_getValueFromEvent(t){const i="vertical"===this.config.type;if("circular"===this.config.type)return this._getValueFromCircularEvent(t);const e=this.elements.track.html_object.getBoundingClientRect();let s;if(i){const i=e.height;s=(e.bottom-t.clientY)/i}else s=(t.clientX-e.left)/e.width;const o=this.config.min+s*(this.config.max-this.config.min);return Math.max(this.config.min,Math.min(this.config.max,o))}_createRipple(t){const i=document.createElement("div");i.style.cssText="\n            position: absolute;\n            width: 20px;\n            height: 20px;\n            background: rgba(33, 150, 243, 0.3);\n            border-radius: 50%;\n            pointer-events: none;\n            transform: translate(-50%, -50%) scale(0);\n            animation: ripple 0.6s ease-out;\n        ";const e=this.elements.track.html_object.getBoundingClientRect();"vertical"===this.config.type?(i.style.left="50%",i.style.top=t.clientY-e.top+"px"):(i.style.left=t.clientX-e.left+"px",i.style.top="50%"),this.elements.track.html_object.appendChild(i),setTimeout((()=>i.remove()),600)}_triggerCallback(t,i){const e=this.config.callbacks[t];"function"==typeof e&&e(i,this)}setValue(t){if(this.currentValue,this.currentValue=Math.max(this.config.min,Math.min(this.config.max,t)),"circular"===this.config.type)return this._setCircularValue(this.currentValue),this;const i="vertical"===this.config.type,e=i?this.config.trackHeight:this.config.trackWidth,s=(this.currentValue-this.config.min)/(this.config.max-this.config.min),o=s*e,n=o;return i?(this.elements.progress.height(o),this.elements.progress.y(e-o),this.elements.thumb.y(e-n-this.config.grip.height/2)):(this.elements.progress.width(o),this.elements.thumb.x(n-this.config.grip.width/2)),this._updateVariationColors(s),this}getValue(){return this.currentValue}getCurrentValue(){return this.currentValue}setConfig(t){this.config={...this.config,...t},this._mergeStyleAPIs(),this._applyStyles()}setGripStyle(t){this.config.grip={...this.config.grip,...t},this._applyGripStyles()}setSupportStyle(t){this.config.support={...this.config.support,...t},this._applySupportStyles()}setRailStyle(t){this.config.rail={...this.config.rail,...t},this._applyRailStyles()}setProgressStyle(t){this.config.progress={...this.config.progress,...t},this._applyProgressStyles()}_applyGripStyles(){if(!this.elements.thumb)return;const t=this.elements.thumb.html_object;this.config.grip.backgroundColor&&(t.style.backgroundColor=this.config.grip.backgroundColor),this.config.grip.border&&(t.style.border=this.config.grip.border),this.config.grip.borderRadius&&(t.style.borderRadius=this.config.grip.borderRadius),this.config.grip.boxShadow&&(t.style.boxShadow=this.config.grip.boxShadow),this.config.grip.cursor&&(t.style.cursor=this.config.grip.cursor),this.config.grip.transition&&(t.style.transition=this.config.grip.transition)}_applySupportStyles(){if(!this.elements.container)return;const t=this.elements.container.html_object;this.config.support.backgroundColor&&(t.style.backgroundColor=this.config.support.backgroundColor),this.config.support.border&&(t.style.border=this.config.support.border),this.config.support.borderRadius&&(t.style.borderRadius=this.config.support.borderRadius),this.config.support.boxShadow&&(t.style.boxShadow=this.config.support.boxShadow),this.config.support.padding&&(t.style.padding=this.config.support.padding)}_applyRailStyles(){if(!this.elements.track)return;const t=this.elements.track.html_object;this.config.rail.backgroundColor&&(t.style.backgroundColor=this.config.rail.backgroundColor),this.config.rail.borderRadius&&(t.style.borderRadius=this.config.rail.borderRadius)}_applyProgressStyles(){if(!this.elements.progress)return;const t=this.elements.progress.html_object;this.config.progress.backgroundColor&&(t.style.backgroundColor=this.config.progress.backgroundColor),this.config.progress.borderRadius&&(t.style.borderRadius=this.config.progress.borderRadius),this.config.progress.boxShadow&&(t.style.boxShadow=this.config.progress.boxShadow),this.config.progress.transition&&(t.style.transition=this.config.progress.transition)}destroy(){this.elements.container&&this.elements.container.html_object.remove()}_createCircularContainer(){const t=2*this.config.circular.radius+this.config.thumbSize+20;this.elements.container=new A({attach:this.config.attach,id:this.config.id+"_container",markup:"div",role:"circular-slider-container",x:this.config.x,y:this.config.y,width:t,height:t,backgroundColor:this.config.colors.container,smooth:12,padding:10,boxShadow:"0 8px 32px rgba(0,0,0,0.12), 0 2px 6px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.04)",overflow:"visible",position:"relative"})}_createCircularTrack(){const{radius:t,strokeWidth:i,startAngle:e,endAngle:s}=this.config.circular,o=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=2*t+i+20;o.setAttribute("width",n),o.setAttribute("height",n),o.style.position="absolute";const r=(2*this.config.circular.radius+this.config.thumbSize+20-n)/2;o.style.left=r+"px",o.style.top=r+"px",o.style.pointerEvents="auto",o.style.cursor="pointer",o.style.zIndex="5",o.style.display="block",o.style.visibility="visible",o.style.opacity="1",o.style.backgroundColor="transparent",o.style.setProperty("border-radius","0","important");const a=t+i/2+10,h=t+i/2+10,c=document.createElementNS("http://www.w3.org/2000/svg","path"),l=(e-90)*Math.PI/180,g=(s-90)*Math.PI/180,u=a+t*Math.cos(l),d=h+t*Math.sin(l),m=a+t*Math.cos(g),p=h+t*Math.sin(g),b=`M ${u} ${d} A ${t} ${t} 0 ${Math.abs(s-e)>180?1:0} 1 ${m} ${p}`;c.setAttribute("d",b),c.setAttribute("fill","none"),c.setAttribute("stroke",this.config.colors.track),c.setAttribute("stroke-width",i),c.setAttribute("stroke-linecap","round"),c.style.display="block",c.style.visibility="visible",c.style.opacity="1",c.addEventListener("click",(t=>{if(t.preventDefault(),t.stopPropagation(),!this.isDragging){const i=this._getValueFromCircularEvent(t);i!==this.currentValue&&(this.setValue(i),this._triggerCallback("onChange",i))}})),o.addEventListener("click",(t=>{if(t.preventDefault(),t.stopPropagation(),!this.isDragging&&t.target!==this.elements.thumb?.html_object){const i=this._getValueFromCircularEvent(t);i!==this.currentValue&&(this.setValue(i),this._triggerCallback("onChange",i))}})),c.addEventListener("mouseenter",(()=>{c.style.opacity="0.8"})),c.addEventListener("mouseleave",(()=>{c.style.opacity="1"})),o.appendChild(c),this.elements.container.html_object.appendChild(o),this.elements.track={html_object:o,arc:c,radius:t}}_createCircularProgress(){const{radius:t,strokeWidth:i}=this.config.circular,e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("fill","none"),e.setAttribute("stroke",this.config.colors.progress),e.setAttribute("stroke-width",i),e.setAttribute("stroke-linecap","round"),this.elements.track.html_object.appendChild(e),this.elements.progress={html_object:e}}_createCircularThumb(){const{radius:t,strokeWidth:i,startAngle:e,endAngle:s}=this.config.circular,o=e+(this.currentValue-this.config.min)/(this.config.max-this.config.min)*(s-e),n=2*t+i+20,r=(2*t+this.config.thumbSize+20-n)/2,a=t+i/2+10,h=t+i/2+10,c=(o-90)*Math.PI/180,l=r+a+t*Math.cos(c)-this.config.thumbSize/2,g=r+h+t*Math.sin(c)-this.config.thumbSize/2;this.elements.thumb=new A({attach:`#${this.config.id}_container`,id:this.config.id+"_thumb",markup:"div",x:l,y:g,width:this.config.thumbSize,height:this.config.thumbSize,backgroundColor:this.config.colors.thumb,smooth:this.config.thumbSize/2,position:"absolute",cursor:"grab",boxShadow:"0 4px 12px rgba(33, 150, 243, 0.4), 0 2px 4px rgba(0,0,0,0.1)",border:"3px solid white",transition:this.config.animations.enabled?`transform ${this.config.animations.duration}s ${this.config.animations.easing}`:"none",zIndex:25,display:"block",visibility:"visible",pointerEvents:"auto"}),this.elements.thumb.html_object.style.display="block",this.elements.thumb.html_object.style.visibility="visible",this.elements.thumb.html_object.style.position="absolute",this.elements.thumb.html_object.style.zIndex="25",this.elements.thumb.html_object.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation()})),this.elements.thumb.html_object.addEventListener("pointerdown",(t=>{t.preventDefault(),t.stopPropagation(),this.isDragging=!0,this.elements.thumb.html_object.style.cursor="grabbing";const i=this.elements.thumb.html_object.style.transition;this.elements.thumb.html_object.style.transition="none",this._triggerCallback("onStart",this.currentValue);const e=t=>{if(!this.isDragging)return;t.preventDefault(),t.stopPropagation();const i=this._getValueFromCircularEvent(t);i!==this.currentValue&&(this.setValue(i),this._triggerCallback("onDrag",i))},s=t=>{this.isDragging&&(this.isDragging=!1,this.elements.thumb.html_object.style.cursor="grab",this.elements.thumb.html_object.style.transition=i,this._triggerCallback("onEnd",this.currentValue),this._triggerCallback("onChange",this.currentValue)),document.removeEventListener("pointermove",e),document.removeEventListener("pointerup",s),document.removeEventListener("pointercancel",s)};document.addEventListener("pointermove",e,{passive:!1}),document.addEventListener("pointerup",s),document.addEventListener("pointercancel",s)}))}_getValueFromCircularEvent(t){const{radius:i,strokeWidth:e,startAngle:s,endAngle:o}=this.config.circular,n=this.elements.container.html_object.getBoundingClientRect(),r=n.left+n.width/2,a=n.top+n.height/2,h=t.clientX-r,c=t.clientY-a;let l=180*Math.atan2(c,h)/Math.PI+90;for(;l<0;)l+=360;for(;l>=360;)l-=360;let g=this._getRelativePositionOnArc(l,s,o);const u=this.config.min+g*(this.config.max-this.config.min),d=Math.round(u/this.config.step)*this.config.step;return Math.max(this.config.min,Math.min(this.config.max,d))}_getRelativePositionOnArc(t,i,e){let s,o=i%360,n=e%360;if(o<0&&(o+=360),n<0&&(n+=360),o<=n){const i=n-o;if(t>=o&&t<=n)s=(t-o)/i;else{this.getCurrentValue();this.config.min,this.config.max,this.config.min;const e=this._getAngularDistance(t,o),r=this._getAngularDistance(t,n);s=e<r||e===r&&t<o+i/2?0:1}}else{const i=360-o+n;if(t>=o||t<=n)s=t>=o?(t-o)/i:(360-o+t)/i;else{s=t<=(n+o)/2?1:0}}return Math.max(0,Math.min(1,s))}_getAngularDistance(t,i){const e=Math.abs(t-i);return Math.min(e,360-e)}_setCircularValue(t){this.currentValue=Math.max(this.config.min,Math.min(this.config.max,t));const i=(this.currentValue-this.config.min)/(this.config.max-this.config.min),{radius:e,strokeWidth:s,startAngle:o,endAngle:n}=this.config.circular,r=o+i*(n-o),a=2*this.config.circular.radius+this.config.thumbSize+20,h=a/2,c=a/2,l=(r-90)*Math.PI/180,g=h+e*Math.cos(l)-this.config.thumbSize/2,u=c+e*Math.sin(l)-this.config.thumbSize/2;if(this.elements.thumb&&this.elements.thumb.html_object){this.elements.thumb.html_object.style.left=g+"px",this.elements.thumb.html_object.style.top=u+"px",this.elements.thumb.html_object.style.display="block",this.elements.thumb.html_object.style.position="absolute",this.elements.thumb.html_object.style.zIndex="20";try{this.elements.thumb.x(g),this.elements.thumb.y(u)}catch(t){}}this._updateCircularProgress(i),this._updateCircularVariationColors(i)}_updateCircularProgress(t){if(!this.elements.progress||!this.elements.progress.html_object)return;const{radius:i,strokeWidth:e,startAngle:s,endAngle:o}=this.config.circular,n=i+e/2+10,r=i+e/2+10,a=s+t*(o-s),h=(s-90)*Math.PI/180,c=(a-90)*Math.PI/180,l=n+i*Math.cos(h),g=r+i*Math.sin(h),u=n+i*Math.cos(c),d=r+i*Math.sin(c),m=Math.abs(a-s);let p;p=t<=.001?`M ${l} ${g} L ${l} ${g}`:`M ${l} ${g} A ${i} ${i} 0 ${m>180?1:0} 1 ${u} ${d}`,this.elements.progress.html_object.setAttribute("d",p)}_updateCircularVariationColors(t){if(!this.config.variation||!Array.isArray(this.config.variation))return;const i=this.config.variation;if(0===i.length)return;if(1===i.length)return this.elements.progress&&this.elements.progress.html_object&&this.elements.progress.html_object.setAttribute("stroke",i[0].color),void(this.elements.thumb&&this.elements.thumb.html_object&&(this.elements.thumb.html_object.style.backgroundColor=i[0].color));let e=i[0],s=i[i.length-1];for(let o=0;o<i.length-1;o++){const n=this._parsePosition(i[o].position)/100,r=this._parsePosition(i[o+1].position)/100;if(t>=n&&t<=r){e=i[o],s=i[o+1];break}}const o=this._parsePosition(e.position)/100,n=this._parsePosition(s.position)/100,r=o===n?0:(t-o)/(n-o),a=this._interpolateColors(e.color,s.color,r);if(this.elements.progress&&this.elements.progress.html_object&&this.elements.progress.html_object.setAttribute("stroke",a),this.elements.thumb&&this.elements.thumb.html_object){this.elements.thumb.html_object.style.backgroundColor=a;const t=this._addAlphaToColor(a,.4);this.elements.thumb.html_object.style.boxShadow=`0 4px 12px ${t}`}}};const t=new class{constructor(){this.version="1.0.0",this.modules=new Map,this.initialized=!1}async init(){try{await this.loadCoreModules(),await this.loadFrameworkModules(),await this.loadApplicationModules(),this.initialized=!0,window.SQUIRREL_VERSION=this.version,window.squirrel=this}catch(t){this.handleInitError(t)}}async loadCoreModules(){await this.loadModulesParallel([{name:"utils",path:"../native/utils.js"}])}async loadFrameworkModules(){await this.loadModulesParallel([{name:"core",path:"../a/a.js"},{name:"apis",path:"../a/apis.js",optional:!0},{name:"particles",path:"../a/particles/all.js",optional:!0}])}async loadApplicationModules(){this.shouldLoadApplication()&&await this.loadModule("application","../application/index.js",!0)}async loadModulesParallel(t){const i=t.map((t=>this.loadModule(t.name,t.path,t.optional)));(await Promise.allSettled(i)).forEach(((i,e)=>{if("rejected"===i.status){t[e].optional}}))}async loadModule(t,i,e=!1){try{const e=await import(i);return this.modules.set(t,e),e}catch(t){return null}}shouldLoadApplication(){return!window.location.search.includes("debug=core")&&(!(window.location.pathname.includes("test-")&&!window.location.search.includes("app=true"))&&!window.location.search.includes("app=false"))}handleInitError(t){const i=document.createElement("div");i.style.cssText="\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            background: #ff4444;\n            color: white;\n            padding: 20px;\n            border-radius: 8px;\n            text-align: center;\n            z-index: 10000;\n            font-family: Arial, sans-serif;\n        ",i.innerHTML=`\n            <h2>❌ Erreur d'initialisation Squirrel</h2>\n            <p>${t.message}</p>\n            <button onclick="location.reload()" style="\n                background: white;\n                color: #ff4444;\n                border: none;\n                padding: 10px 20px;\n                border-radius: 4px;\n                cursor: pointer;\n                margin-top: 10px;\n            ">Recharger</button>\n        `,document.body.appendChild(i)}getModule(t){return this.modules.get(t)}isReady(){return this.initialized}getVersion(){return this.version}listModules(){return Array.from(this.modules.keys())}};return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>t.init())):t.init(),t}();

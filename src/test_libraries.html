<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Libraries Loading</title>
    <link rel="stylesheet" href="js/leaflet.min.css">
    <script src="js/gsap.min.js"></script>
    <script src="js/tone.min.js"></script>
    <script src="js/leaflet.min.js"></script>
    <script src="js/wavesurfer.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { padding: 10px; margin: 5px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        #mapid { height: 200px; margin: 10px 0; border: 1px solid #ccc; }
        #waveform { height: 100px; margin: 10px 0; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>🧪 Libraries Test Page</h1>
    <div id="results"></div>
    
    <h2>📍 Leaflet Map Test</h2>
    <div id="mapid"></div>
    
    <h2>🎵 Wavesurfer Test</h2>
    <div id="waveform"></div>
    
    <h2>🎭 GSAP Animation Test</h2>
    <div id="box" style="width: 50px; height: 50px; background: blue; margin: 10px 0;"></div>
    
    <script type="module">
        const results = document.getElementById('results');
        
        function addResult(name, success, details) {
            const div = document.createElement('div');
            div.className = `status ${success ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${name}:</strong> ${success ? '✅ Loaded' : '❌ Failed'} ${details ? `- ${details}` : ''}`;
            results.appendChild(div);
        }
        
        // Test GSAP
        try {
            if (typeof gsap !== 'undefined') {
                addResult('GSAP', true, `v${gsap.version}`);
                
                // Test animation
                gsap.to("#box", {duration: 2, x: 100, repeat: -1, yoyo: true});
            } else {
                addResult('GSAP', false, 'gsap object not found');
            }
        } catch (e) {
            addResult('GSAP', false, e.message);
        }
        
        // Test Tone.js
        try {
            if (typeof Tone !== 'undefined') {
                addResult('Tone.js', true, `v${Tone.version}`);
            } else {
                addResult('Tone.js', false, 'Tone object not found');
            }
        } catch (e) {
            addResult('Tone.js', false, e.message);
        }
        
        // Test Leaflet
        try {
            if (typeof L !== 'undefined') {
                addResult('Leaflet', true, `v${L.version}`);
                
                // Create map
                const map = L.map('mapid').setView([48.8566, 2.3522], 13);
                L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; OpenStreetMap contributors'
                }).addTo(map);
                
                L.marker([48.8566, 2.3522]).addTo(map)
                    .bindPopup('Paris, France')
                    .openPopup();
            } else {
                addResult('Leaflet', false, 'L object not found');
            }
        } catch (e) {
            addResult('Leaflet', false, e.message);
        }
        
        // Test Wavesurfer
        try {
            if (typeof WaveSurfer !== 'undefined') {
                addResult('Wavesurfer', true, `v${WaveSurfer.VERSION || 'unknown'}`);
                
                // Create wavesurfer instance
                const wavesurfer = WaveSurfer.create({
                    container: '#waveform',
                    waveColor: 'violet',
                    progressColor: 'purple'
                });
            } else {
                addResult('Wavesurfer', false, 'WaveSurfer object not found');
            }
        } catch (e) {
            addResult('Wavesurfer', false, e.message);
        }
        
        // Test Three.js (dynamic import)
        try {
            import('./js/three.min.js').then((THREE) => {
                addResult('Three.js', true, `v${THREE.REVISION}`);
                console.log('Three.js loaded:', THREE);
            }).catch((e) => {
                addResult('Three.js', false, e.message);
            });
        } catch (e) {
            addResult('Three.js', false, e.message);
        }
        
        // Show total libraries count
        setTimeout(() => {
            const total = results.children.length;
            const loaded = document.querySelectorAll('.success').length;
            
            const summary = document.createElement('div');
            summary.style.marginTop = '20px';
            summary.style.padding = '15px';
            summary.style.background = loaded === total ? '#d4edda' : '#fff3cd';
            summary.style.border = '1px solid ' + (loaded === total ? '#c3e6cb' : '#ffeaa7');
            summary.style.borderRadius = '5px';
            summary.innerHTML = `<h3>📊 Summary: ${loaded}/${total} libraries loaded successfully</h3>`;
            
            results.appendChild(summary);
        }, 1000);
    </script>
</body>
</html>

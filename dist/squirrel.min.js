!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Squirrel=t()}(this,function(){"use strict";const e=new Map,t=new Map,s=new WeakMap,n=new WeakMap,r=e=>{if(t.has(e))return t.get(e);const s=e.replace(/([A-Z])/g,"-$1").toLowerCase();return t.set(e,s),s},o=e=>e.startsWith("on"),i=new Set(["draggable","hidden","spellcheck","contenteditable","disabled","checked","readonly"]),c=(e,t)=>{t&&("string"==typeof t?-1===t.indexOf(" ")?e.classList.add(t):e.classList.add(...t.split(" ")):Array.isArray(t)&&e.classList.add(...t))},a=(t,d={})=>{const l=e.get(t)||{},f=(u=l.tag||d.tag||t||"div",document.createElement(u));var u;const p={...l,...d};if((l.css||d.css)&&("string"==typeof l.css&&"string"==typeof d.css?p.css=l.css+";"+d.css:"object"==typeof l.css&&"object"==typeof d.css?p.css={...l.css,...d.css}:p.css=d.css||l.css),(l.attrs||d.attrs)&&(p.attrs={...l.attrs||{},...d.attrs||{}}),p.mark&&f.setAttribute("data-hyperfactory","true"),p.id&&(f.id=p.id),p.text&&(f.textContent=p.text),c(f,p.class),p.attrs)for(const[e,t]of Object.entries(p.attrs))null==t?f.removeAttribute(e):i.has(e)?t?f.setAttribute(e,""):f.removeAttribute(e):f.setAttribute(e,t);if(p.css)if("string"==typeof p.css)f.style.cssText=p.css;else for(const e in p.css)if(p.css.hasOwnProperty(e)){const t=p.css[e],s=r(e);null==t?f.style.removeProperty(s):f.style.setProperty(s,t)}s.set(f,{});for(const e in p)if(o(e)&&"function"==typeof p[e]){const t=e.slice(2).toLowerCase(),n=p[e];f.addEventListener(t,n),s.get(f)[t]=n}p.children&&p.children.forEach(e=>{const t=a(e.id,e);f.appendChild(t)}),f.$=e=>{if("text"in e&&(f.textContent=e.text),e.class&&c(f,e.class),e.css)if("string"==typeof e.css)f.style.cssText=e.css;else for(const t in e.css)if(e.css.hasOwnProperty(t)){const s=e.css[t],n=r(t);null==s?f.style.removeProperty(n):f.style.setProperty(n,s)}if(e.attrs)for(const t in e.attrs)if(e.attrs.hasOwnProperty(t)){const s=e.attrs[t];null==s?f.removeAttribute(t):i.has(t)?s?f.setAttribute(t,""):f.removeAttribute(t):f.setAttribute(t,s)}const t=s.get(f);for(const s in e)if(o(s)&&"function"==typeof e[s]){const n=s.slice(2).toLowerCase(),r=e[s];t[n]&&f.removeEventListener(n,t[n]),f.addEventListener(n,r),t[n]=r}return f},f._=f.style;const y=p.parent||"#view";if("string"==typeof y){const e=document.querySelector(y);e?e.appendChild(f):console.warn(`Parent selector "${y}" not found`)}else y.appendChild(f);return f.animate=(e,t={})=>f.animate(e,{duration:t.duration||300,easing:t.easing||"ease",fill:"forwards"}).finished,f.remove=()=>{const e=n.get(f);e&&(e.forEach(e=>e.disconnect()),n.delete(f));const t=s.get(f);if(t){for(const e in t)t.hasOwnProperty(e)&&f.removeEventListener(e,t[e]);s.delete(f)}f.parentNode?.removeChild(f)},f};var d={$:a,define:(t,s)=>(e.set(t,s),s),batch:(...e)=>{requestAnimationFrame(()=>{e.forEach(e=>{try{e()}catch(e){console.error("Batch operation failed:",e)}})})},observeMutations:(e,t,s={})=>{const r=new MutationObserver(e=>{e.forEach(e=>t(e))});r.observe(e,{attributes:!0,childList:!0,subtree:!0,...s}),n.has(e)||n.set(e,[]),n.get(e).push(r)}};if("undefined"!=typeof window){if(window.$=d.$,!document.getElementById("view")){const e=document.createElement("div");e.id="view",document.body.appendChild(e)}setTimeout(()=>{window.squirrelReady=!0,window.dispatchEvent(new Event("squirrel:ready"))},0)}return d});
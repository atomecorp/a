/*! Squirrel.js v1.0.0 | MIT License */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Squirrel={})}(this,(function(e){"use strict";const t=new Map,n=new Map,i=new WeakMap,o=new WeakMap,s=e=>{if(n.has(e))return n.get(e);const t=e.replace(/([A-Z])/g,"-$1").toLowerCase();return n.set(e,t),t},r=e=>e.startsWith("on"),a=new Set(["draggable","hidden","spellcheck","contenteditable","disabled","checked","readonly"]),l=(e,t)=>{t&&("string"==typeof t?-1===t.indexOf(" ")?e.classList.add(t):e.classList.add(...t.split(" ")):Array.isArray(t)&&e.classList.add(...t))},c=(e,n={})=>{const d=t.get(e)||{},h=(p=d.tag||n.tag||e||"div",document.createElement(p));var p;const u={...d,...n};if((d.css||n.css)&&("string"==typeof d.css&&"string"==typeof n.css?u.css=d.css+";"+n.css:"object"==typeof d.css&&"object"==typeof n.css?u.css={...d.css,...n.css}:u.css=n.css||d.css),(d.attrs||n.attrs)&&(u.attrs={...d.attrs||{},...n.attrs||{}}),u.mark&&h.setAttribute("data-hyperfactory","true"),u.id&&(h.id=u.id),u.text&&(h.textContent=u.text),l(h,u.class),u.attrs)for(const[e,t]of Object.entries(u.attrs))null==t?h.removeAttribute(e):a.has(e)?t?h.setAttribute(e,""):h.removeAttribute(e):h.setAttribute(e,t);if(u.css)if("string"==typeof u.css)h.style.cssText=u.css;else for(const e in u.css)if(u.css.hasOwnProperty(e)){const t=u.css[e],n=s(e);null==t?h.style.removeProperty(n):h.style.setProperty(n,t)}i.set(h,{});for(const e in u)if(r(e)&&"function"==typeof u[e]){const t=e.slice(2).toLowerCase(),n=u[e];h.addEventListener(t,n),i.get(h)[t]=n}u.children&&u.children.forEach((e=>{const t=c(e.id,e);h.appendChild(t)})),h.$=e=>{if("text"in e&&(h.textContent=e.text),e.class&&l(h,e.class),e.css)if("string"==typeof e.css)h.style.cssText=e.css;else for(const t in e.css)if(e.css.hasOwnProperty(t)){const n=e.css[t],i=s(t);null==n?h.style.removeProperty(i):h.style.setProperty(i,n)}if(e.attrs)for(const t in e.attrs)if(e.attrs.hasOwnProperty(t)){const n=e.attrs[t];null==n?h.removeAttribute(t):a.has(t)?n?h.setAttribute(t,""):h.removeAttribute(t):h.setAttribute(t,n)}const t=i.get(h);for(const n in e)if(r(n)&&"function"==typeof e[n]){const i=n.slice(2).toLowerCase(),o=e[n];t[i]&&h.removeEventListener(i,t[i]),h.addEventListener(i,o),t[i]=o}return h},h._=h.style;const g=u.parent||"#view";if("string"==typeof g){const e=document.querySelector(g);e?e.appendChild(h):console.warn(`Parent selector "${g}" not found`)}else g.appendChild(h);return h.animate=(e,t={})=>h.animate(e,{duration:t.duration||300,easing:t.easing||"ease",fill:"forwards"}).finished,h.remove=()=>{const e=o.get(h);e&&(e.forEach((e=>e.disconnect())),o.delete(h));const t=i.get(h);if(t){for(const e in t)t.hasOwnProperty(e)&&h.removeEventListener(e,t[e]);i.delete(h)}h.parentNode?.removeChild(h)},h},d=(e,n)=>(t.set(e,n),n),h=(e,t,n={})=>{const i=new MutationObserver((e=>{e.forEach((e=>t(e)))}));i.observe(e,{attributes:!0,childList:!0,subtree:!0,...n}),o.has(e)||o.set(e,[]),o.get(e).push(i)};window.puts=function(e){console.log(e)},window.print=function(e){console.log("[PRINT]",e)},window.grab=function(){const e=new Map;return function(t){if(!t)return null;const n=_registry[t];if(n)return n;if(e.has(t)){const n=e.get(t);if(n&&n.isConnected)return n;e.delete(t)}const i=document.getElementById(t);if(!i)return null;if(!i._enhanced){i._enhanced=!0;["width","height","color","backgroundColor","x","y"].forEach((e=>{const t="x"===e?"left":"y"===e?"top":e;i[e]=function(e){return 0===arguments.length?getComputedStyle(this)[t]:(this.style[t]=window._isNumber&&window._isNumber(e)?window._formatSize(e):e,this)}}))}return e.set(t,i),i}}(),Object.prototype.define_method=function(e,t){return this[e]=t,this},Array.prototype.each=function(e){return this.forEach(e),this},Object.prototype.inspect=function(){return AJS.inspect(this)};window.wait=(e,t)=>{if("function"!=typeof t)return new Promise((t=>setTimeout(t,e)));setTimeout(t,e)},window.log=window.puts,window._registry=window._registry||{},window.AJS=window.AJS||{inspect:function(e){return JSON.stringify(e,null,2)}};class p{constructor(){this.plugins=new Map,this.loadedPlugins=new Set,this.componentsPath="./components/",this.registeredComponents=[]}async discover(){const e=["List_builder","badge_builder","button_builder","draggable_builder","matrix_builder","menu_builder","slider_builder","table_builder","tooltip_builder","unit_builder"];return e.forEach((e=>{this.registerLazyPlugin(e)})),this.registeredComponents=e,e}registerLazyPlugin(e){const t=this.getPluginName(e);this.plugins.set(t,{componentFile:e,loaded:!1,instance:null,loader:()=>this.loadComponent(e,t)})}getPluginName(e){const t=e.replace("_builder","").replace(".js","");return t.charAt(0).toUpperCase()+t.slice(1)}async loadComponent(e,t){if(this.loadedPlugins.has(t))return this.plugins.get(t);try{const n=`${this.componentsPath}${e}.js`,i=await import(n);this.exposePlugin(e,i,t);const o=this.plugins.get(t);return o.loaded=!0,o.instance=window[t],this.loadedPlugins.add(t),o}catch(e){throw console.error(`❌ Erreur lors du chargement du plugin "${t}":`,e),e}}getExportName(e,t){if(t.default)return"default";return Object.keys(t)[0]||"default"}exposePlugin(e,t,n){if(t.default&&"function"==typeof t.default.create)return window[n]=t.default.create,window[n+"Styles"]=t.default,"draggable_builder"===e&&(window.makeDraggable=t.makeDraggable,window.makeDraggableWithDrop=t.makeDraggableWithDrop,window.makeDropZone=t.makeDropZone),void("unit_builder"===e&&Object.assign(window[n],{deleteUnit:t.deleteUnit,deleteUnits:t.deleteUnits,selectUnit:t.selectUnit,selectUnits:t.selectUnits,deselectUnit:t.deselectUnit,deselectUnits:t.deselectUnits,deselectAllUnits:t.deselectAllUnits,getSelectedUnits:t.getSelectedUnits,renameUnit:t.renameUnit,renameUnits:t.renameUnits,connectUnits:t.connectUnits,disconnectUnits:t.disconnectUnits,getAllConnections:t.getAllConnections,getUnit:t.getUnit,getAllUnits:t.getAllUnits}));if(t.default&&"function"==typeof t.default)return void(window[n]=t.default);const i=`create${n}`;if(t[i]&&"function"==typeof t[i])return void(window[n]=t[i]);const o=Object.keys(t).filter((e=>e.startsWith("create")&&"function"==typeof t[e]));if(o.length>0)return void(window[n]=t[o[0]]);const s=Object.keys(t).filter((e=>"function"==typeof t[e]));s.length>0?window[n]=t[s[0]]:t.default?window[n]=t.default:this.exposePluginManual(e,t,n)}exposePluginManual(e,t,n){if("draggable_builder"===e)window.draggable=t.draggable,window.makeDraggable=t.makeDraggable,window.makeDraggableWithDrop=t.makeDraggableWithDrop,window.makeDropZone=t.makeDropZone,window.Draggable=t.draggable;else{const e=Object.keys(t)[0];e?window[n]=t[e]:(console.warn(`❌ Impossible d'exposer le plugin ${n} automatiquement`),console.warn("   Module exports:",Object.keys(t)))}}async load(e){const t=this.plugins.get(e);if(!t)throw new Error(`Plugin "${e}" non trouvé. Plugins disponibles: ${Array.from(this.plugins.keys()).join(", ")}`);return t.loaded||await t.loader(),t.instance}async loadMultiple(e){const t={};for(const n of e)try{t[n]=await this.load(n)}catch(e){console.error(`Erreur lors du chargement de ${n}:`,e),t[n]=null}return t}async loadAll(){const e=Array.from(this.plugins.keys());return await this.loadMultiple(e)}getAvailablePlugins(){return Array.from(this.plugins.keys())}getLoadedPlugins(){return Array.from(this.loadedPlugins)}getStatus(){const e=this.getAvailablePlugins(),t=this.getLoadedPlugins();return{available:e.length,loaded:t.length,availableList:e,loadedList:t,pending:e.filter((e=>!t.includes(e)))}}loadSync(e){const t=this.plugins.get(e);return t?t.loaded?t.instance:(console.warn(`⚠️ Tentative de chargement synchrone du plugin "${e}" non préchargé`),this.load(e).catch((t=>{console.error(`❌ Erreur chargement synchrone de "${e}":`,t)})),null):(console.error(`❌ Plugin "${e}" non trouvé. Plugins disponibles: ${Array.from(this.plugins.keys()).join(", ")}`),null)}}window.PluginManager=p;class u{constructor(e){this.pluginManager=e}async use(e){"string"==typeof e&&(e=[e]);return await this.pluginManager.loadMultiple(e)}async plugin(e){return await this.pluginManager.load(e)}hasPlugin(e){return this.pluginManager.plugins.has(e)}isPluginLoaded(e){return this.pluginManager.loadedPlugins.has(e)}getAvailablePlugins(){return this.pluginManager.getAvailablePlugins()}getLoadedPlugins(){return this.pluginManager.getLoadedPlugins()}getPluginStatus(){return this.pluginManager.getStatus()}async create(e,...t){await this.use([e]);const n=window[e];if(!n)throw new Error(`Composant "${e}" non trouvé après chargement`);return new n(...t)}async button(...e){return await this.create("Button",...e)}async slider(...e){return await this.create("Slider",...e)}async matrix(...e){return await this.create("Matrix",...e)}async module(...e){return await this.create("Module",...e)}async table(...e){return await this.create("Table",...e)}async list(...e){return await this.create("List",...e)}async menu(...e){return await this.create("Menu",...e)}}var g=Object.freeze({__proto__:null,default:class{constructor(e={}){this.config={id:e.id||`list-${Date.now()}`,items:e.items||[],position:{x:0,y:0,...e.position},size:{width:300,height:400,...e.size},spacing:{vertical:e.spacing?.vertical??4,horizontal:e.spacing?.horizontal??0,itemPadding:e.spacing?.itemPadding??16,marginTop:e.spacing?.marginTop??0,marginBottom:e.spacing?.marginBottom??0,...e.spacing},attach:e.attach||"body",itemStyle:{fontSize:e.itemStyle?.fontSize??"14px",fontWeight:e.itemStyle?.fontWeight??"400",lineHeight:e.itemStyle?.lineHeight??"1.4",textColor:e.itemStyle?.textColor??"#212121",backgroundColor:e.itemStyle?.backgroundColor??"#ffffff",borderRadius:e.itemStyle?.borderRadius??"8px",...e.itemStyle},states:{hover:{backgroundColor:"#f5f5f5",boxShadow:"0 2px 4px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.24)",transform:"translateY(-1px)",...e.states?.hover},selected:{backgroundColor:"#1976d2",color:"#ffffff",boxShadow:"0 4px 8px rgba(25,118,210,0.3)",transform:"translateY(-1px)",...e.states?.selected},...e.states},containerStyle:e.containerStyle||{},selectable:!1!==e.selectable,multiSelect:e.multiSelect||!1,elevation:e.elevation??2,rippleEffect:!1!==e.rippleEffect,debug:e.debug||!1},this.itemsMap=new Map,this.itemStates=new Map,this.itemElements=new Map,this.selectedItems=new Set,this.callbacks={onItemClick:e.onItemClick||null,onItemSelect:e.onItemSelect||null,onItemHover:e.onItemHover||null,onItemLeave:e.onItemLeave||null},this.container=null,this.isInitialized=!1,this.init()}init(){try{this.createContainer(),this.createItems(),this.setupEventListeners(),this.isInitialized=!0,this.config.debug}catch(e){console.error(`❌ Erreur lors de l'initialisation de List "${this.config.id}":`,e)}}createContainer(){const e="string"==typeof this.config.attach?document.querySelector(this.config.attach):this.config.attach;if(!e)throw new Error(`Point d'attachement "${this.config.attach}" non trouvé`);this.container=document.createElement("div"),this.container.id=this.config.id,this.container.className="list-container",this.applyContainerStyles(),e.appendChild(this.container)}applyContainerStyles(){const e=this.getElevationShadow(this.config.elevation),t={...{position:"absolute",left:`${this.config.position.x}px`,top:`${this.config.position.y}px`,width:`${this.config.size.width}px`,height:`${this.config.size.height}px`,overflow:"auto",background:"#ffffff",borderRadius:"12px",padding:"8px",boxShadow:e,border:"none",fontFamily:'Roboto, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif'},...this.config.containerStyle};Object.assign(this.container.style,t)}getElevationShadow(e){const t={0:"none",1:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)",2:"0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)",3:"0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)",4:"0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)",5:"0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22)"};return t[e]||t[2]}createItems(){this.config.items.forEach(((e,t)=>{const n=this.createItem(e,t);this.container.appendChild(n)}))}createItem(e,t){const n=document.createElement("div"),i=e.id||`item-${t}`;return n.id=i,n.className="list-item",n.textContent=e.content||e.text||`Élément ${t+1}`,this.itemsMap.set(i,e),this.itemElements.set(i,n),this.itemStates.set(i,"default"),this.applyItemStyles(n,e),n}applyItemStyles(e,t){const n={...{padding:`${this.config.spacing.itemPadding}px`,marginTop:`${this.config.spacing.marginTop}px`,marginBottom:`${this.config.spacing.vertical}px`,marginLeft:`${this.config.spacing.horizontal}px`,marginRight:`${this.config.spacing.horizontal}px`,fontSize:this.config.itemStyle.fontSize,fontWeight:this.config.itemStyle.fontWeight,lineHeight:this.config.itemStyle.lineHeight,color:this.config.itemStyle.textColor,fontFamily:"inherit",background:this.config.itemStyle.backgroundColor,borderRadius:this.config.itemStyle.borderRadius,border:"none",boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1)",position:"relative",overflow:"hidden",userSelect:"none"},...this.config.itemStyle.default||{},...t.style||{}};Object.assign(e.style,n),this.config.rippleEffect&&this.addRippleEffect(e)}addRippleEffect(e){e.addEventListener("click",(t=>{const n=document.createElement("span"),i=e.getBoundingClientRect(),o=Math.max(i.width,i.height),s=t.clientX-i.left-o/2,r=t.clientY-i.top-o/2;if(n.style.cssText=`\n        position: absolute;\n        width: ${o}px;\n        height: ${o}px;\n        left: ${s}px;\n        top: ${r}px;\n        background: rgba(255, 255, 255, 0.6);\n        border-radius: 50%;\n        transform: scale(0);\n        animation: ripple 0.6s linear;\n        pointer-events: none;\n        z-index: 1;\n      `,!document.getElementById("ripple-styles")){const e=document.createElement("style");e.id="ripple-styles",e.textContent="\n          @keyframes ripple {\n            to {\n              transform: scale(4);\n              opacity: 0;\n            }\n          }\n        ",document.head.appendChild(e)}e.appendChild(n),setTimeout((()=>n.remove()),600)}))}setupEventListeners(){this.container.addEventListener("click",(e=>{const t=e.target.closest(".list-item");t&&this.handleItemClick(t,e)})),this.container.addEventListener("mouseover",(e=>{const t=e.target.closest(".list-item");t&&this.handleItemHover(t)})),this.container.addEventListener("mouseout",(e=>{const t=e.target.closest(".list-item");t&&this.handleItemLeave(t)}))}handleItemClick(e,t){const n=e.id,i=this.itemsMap.get(n),o=Array.from(this.itemElements.values()).indexOf(e);this.config.selectable&&this.toggleSelection(n),this.callbacks.onItemClick&&this.callbacks.onItemClick(i,o,t)}handleItemHover(e){const t=e.id;if(this.applyState(t,"hover"),this.callbacks.onItemHover){const e=this.itemsMap.get(t);this.callbacks.onItemHover(e)}}handleItemLeave(e){const t=e.id;if("hover"===this.itemStates.get(t)){const e=this.selectedItems.has(t);this.applyState(t,e?"selected":"default")}if(this.callbacks.onItemLeave){const e=this.itemsMap.get(t);this.callbacks.onItemLeave(e)}}applyState(e,t){const n=this.itemElements.get(e);if(!n)return;const i=this.config.states[t]||{};if("default"===t){const t=this.itemsMap.get(e);this.applyItemStyles(n,t)}else Object.assign(n.style,i);this.itemStates.set(e,t)}toggleSelection(e){const t=this.selectedItems.has(e);if(this.config.multiSelect||t||this.selectedItems.forEach((e=>{this.selectedItems.delete(e),this.applyState(e,"default")})),t?(this.selectedItems.delete(e),this.applyState(e,"default")):(this.selectedItems.add(e),this.applyState(e,"selected")),this.callbacks.onItemSelect){const n=this.itemsMap.get(e);this.callbacks.onItemSelect(n,!t)}}addItem(e){const t=this.config.items.length;this.config.items.push(e);const n=this.createItem(e,t);return this.container.appendChild(n),e.id||`item-${t}`}removeItem(e){const t=this.itemElements.get(e);t&&(t.remove(),this.itemElements.delete(e),this.itemsMap.delete(e),this.itemStates.delete(e),this.selectedItems.delete(e))}getSelectedItems(){return Array.from(this.selectedItems).map((e=>this.itemsMap.get(e)))}clearSelection(){this.selectedItems.forEach((e=>{this.applyState(e,"default")})),this.selectedItems.clear()}updateSpacing(e){this.config.spacing={...this.config.spacing,...e},this.itemElements.forEach(((e,t)=>{const n=this.itemsMap.get(t);this.applyItemStyles(e,n)}))}updateTextStyle(e){this.config.itemStyle={...this.config.itemStyle,...e},this.itemElements.forEach(((e,t)=>{const n=this.itemsMap.get(t);this.applyItemStyles(e,n)}))}destroy(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.itemsMap.clear(),this.itemElements.clear(),this.itemStates.clear(),this.selectedItems.clear(),this.isInitialized=!1}}});d("badge-element",{tag:"span",class:"hs-badge",css:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.5px"}});const m=(e={})=>{const{text:t="Badge",variant:n="primary",css:i={},onclick:o,...s}=e,r={primary:{backgroundColor:"#007bff",color:"white"},success:{backgroundColor:"#28a745",color:"white"},warning:{backgroundColor:"#ffc107",color:"#212529"},danger:{backgroundColor:"#dc3545",color:"white"},info:{backgroundColor:"#17a2b8",color:"white"},light:{backgroundColor:"#f8f9fa",color:"#212529",border:"1px solid #dee2e6"},dark:{backgroundColor:"#343a40",color:"white"}};return c("badge-element",{text:t,css:{...r[n]||r.primary,...i,cursor:o?"pointer":"default"},onclick:o||null,...s})};var f={create:m,variants:{primary:"#007bff",success:"#28a745",warning:"#ffc107",danger:"#dc3545",info:"#17a2b8",light:"#f8f9fa",dark:"#343a40"}},b=Object.freeze({__proto__:null,createBadge:m,default:f});d("button-container",{tag:"button",class:"hs-button",text:"hello",css:{position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"8px 16px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f8f9fa",color:"#333",fontSize:"14px",fontFamily:"system-ui, sans-serif",cursor:"pointer",transition:"all 0.2s ease",outline:"none"},attrs:{type:"button"}}),d("button-icon",{tag:"span",class:"hs-button-icon",css:{display:"inline-flex",alignItems:"center",justifyContent:"center",marginRight:"6px",fontSize:"16px"}}),d("button-text",{tag:"span",class:"hs-button-text",css:{fontSize:"inherit",fontWeight:"400",lineHeight:"1"}}),d("button-badge",{tag:"span",class:"hs-button-badge",css:{position:"absolute",top:"-6px",right:"-6px",minWidth:"18px",height:"18px",padding:"0 4px",borderRadius:"9px",backgroundColor:"#dc3545",color:"white",fontSize:"11px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center"}});const y={primary:{backgroundColor:"#007bff",color:"white",borderColor:"#007bff"},secondary:{backgroundColor:"#6c757d",color:"white",borderColor:"#6c757d"},success:{backgroundColor:"#28a745",color:"white",borderColor:"#28a745"},danger:{backgroundColor:"#dc3545",color:"white",borderColor:"#dc3545"},warning:{backgroundColor:"#ffc107",color:"#212529",borderColor:"#ffc107"},outline:{backgroundColor:"transparent",borderWidth:"2px"},ghost:{backgroundColor:"transparent",border:"none",boxShadow:"none"}},x={xs:{padding:"4px 8px",fontSize:"11px"},sm:{padding:"6px 12px",fontSize:"12px"},md:{padding:"8px 16px",fontSize:"14px"},lg:{padding:"12px 24px",fontSize:"16px"},xl:{padding:"16px 32px",fontSize:"18px"}},C=(e={})=>{const{text:t="Button",icon:n,badge:i,variant:o="default",size:s="md",onClick:r,skin:a={},id:l,disabled:d=!1,...h}=e,p=l||`btn_${Date.now()}_${Math.random().toString(36).substr(2,6)}`;let u={...y[o]||{},...x[s]||{}};a.container&&(u={...u,...a.container}),d&&(u.opacity="0.6",u.cursor="not-allowed",u.pointerEvents="none");const g=c("button-container",{id:p,css:u,attrs:{disabled:d},onClick:d?void 0:r,...h});if(n){const e=c("button-icon",{id:`${p}_icon`,text:n,css:a.icon||{}});t||e.$({css:{marginRight:"0"}}),g.appendChild(e)}if(t){const e=c("button-text",{id:`${p}_text`,text:t,css:a.text||{}});g.appendChild(e)}if(void 0!==i){const e=c("button-badge",{id:`${p}_badge`,text:i.toString(),css:a.badge||{}});g.appendChild(e)}return g.updateText=e=>{const t=g.querySelector(".hs-button-text");return t&&(t.textContent=e),g},g.updateBadge=e=>{const t=g.querySelector(".hs-button-badge");if(t)t.textContent=e.toString();else if(void 0!==e){const t=c("button-badge",{id:`${p}_badge_new`,text:e.toString(),css:a.badge||{}});g.appendChild(t)}return g},g.setVariant=e=>{const t=y[e]||{};return g.$({css:t}),g},g.setDisabled=e=>(g.disabled=e,g.$({css:{opacity:e?"0.6":"1",cursor:e?"not-allowed":"pointer",pointerEvents:e?"none":"auto"}}),g),g},v=e=>C({...e,variant:"primary"}),w=e=>C({...e,variant:"secondary"}),S=e=>C({...e,variant:"success"}),k=e=>C({...e,variant:"danger"}),E=e=>C({...e,variant:"warning"}),M=e=>C({...e,text:"",skin:{container:{padding:"8px",borderRadius:"50%"},...e.skin}}),L=e=>C({...e,variant:"outline",skin:{container:{color:y[e.color||"primary"]?.backgroundColor||"#007bff",borderColor:y[e.color||"primary"]?.backgroundColor||"#007bff"},...e.skin}}),I=(e={})=>({...e,skin:{container:{position:"relative",width:"60px",height:"34px",padding:"0",borderRadius:"17px",backgroundColor:"#ccc",border:"none",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"flex-start",fontFamily:"Roboto, Arial, sans-serif",fontSize:"0px"},icon:{position:"absolute",left:"2px",top:"2px",width:"30px",height:"30px",borderRadius:"50%",backgroundColor:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0px",transition:"all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1)",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",transform:"translateX(0px)"},...e.skin||{}},icon:e.icon||"○",text:e.text||"OFF",id:e.id||"material-toggle"});var D={create:C,primary:v,secondary:w,success:S,danger:k,warning:E,icon:M,outline:L,materialSwitch:function(e){return C(I(e))}},z=Object.freeze({__proto__:null,buttonSizes:x,buttonStyles:y,createButton:C,createDangerButton:k,createIconButton:M,createOutlineButton:L,createPrimaryButton:v,createSecondaryButton:w,createSuccessButton:S,createWarningButton:E,default:D});function R(e,t={}){const{onDragEnter:n=()=>{},onDragOver:i=()=>{},onDragLeave:o=()=>{},onDrop:s=()=>{},acceptTypes:r=[],hoverClass:a="drop-hover",activeClass:l="drop-active",acceptClass:c="drop-accept",rejectClass:d="drop-reject"}=t,h="string"==typeof e?document.querySelector(e):e;if(!h)return;let p=0;const u=e=>{e.preventDefault(),p++,1===p&&(h.classList.add(a),n(e,h))},g=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move",i(e,h)},m=e=>{e.preventDefault(),p--,0===p&&(h.classList.remove(a,c,d),o(e,h))},f=e=>{e.preventDefault(),p=0,h.classList.remove(a,c,d);const t={};try{const n=e.dataTransfer.getData("application/json");n&&Object.assign(t,JSON.parse(n))}catch(e){console.warn("Erreur parsing des données de drop:",e)}t.text=e.dataTransfer.getData("text/plain"),s(e,h,t)};return h.addEventListener("dragenter",u),h.addEventListener("dragover",g),h.addEventListener("dragleave",m),h.addEventListener("drop",f),()=>{h.removeEventListener("dragenter",u),h.removeEventListener("dragover",g),h.removeEventListener("dragleave",m),h.removeEventListener("drop",f),h.classList.remove(a,l,c,d)}}function A(e,t={}){const{onDragStart:n=()=>{},onDragMove:i=()=>{},onDragEnd:o=()=>{},cursor:s="move",constrainToParent:r=!1,bounds:a=null,rotationFactor:l=0,scaleFactor:c=0,enableHTML5:d=!0,transferData:h={},ghostImage:p=null,dragStartClass:u="dragging",onHTML5DragStart:g=()=>{},onHTML5DragEnd:m=()=>{},onDropDetection:f=()=>{}}=t;e.style.cursor=s,e.style.userSelect="none",d&&(e.draggable=!0);let b=null,y=null,x=!1;d&&(e.addEventListener("dragstart",(t=>{u&&e.classList.add(u),p&&t.dataTransfer.setDragImage(p,0,0),t.dataTransfer.effectAllowed="move",h&&t.dataTransfer.setData("application/json",JSON.stringify(h)),t.dataTransfer.setData("text/plain",e.textContent||""),g(t,e)})),e.addEventListener("dragend",(t=>{u&&e.classList.remove(u),m(t,e)})));const C=t=>{if(d&&0===t.button&&t.target.draggable)return;t.preventDefault(),t.stopPropagation(),x=!0;const s=e.style.transition;e.style.transition="none";const r=e.getBoundingClientRect();var a,l;b={x:r.left,y:r.top,transform:e.style.transform||"",transition:s},a=t.clientX,l=t.clientY,y=e.cloneNode(!0),y.style.position="fixed",y.style.left=a-30+"px",y.style.top=l-20+"px",y.style.width=e.offsetWidth+"px",y.style.height=e.offsetHeight+"px",y.style.opacity="0.7",y.style.transform="scale(0.9) rotate(5deg)",y.style.zIndex="9999",y.style.pointerEvents="none",y.style.boxShadow="0 8px 16px rgba(0,0,0,0.3)",y.style.borderRadius="8px",y.style.transition="none",y.style.border="2px solid rgba(255,255,255,0.5)",document.body.appendChild(y),u&&e.classList.add(u);const c=t.clientX,h=t.clientY;n(e,c,h,0,0);const p=t=>{if(!x)return;y&&(y.style.left=t.clientX-30+"px",y.style.top=t.clientY-20+"px");const n=t.clientX-c,o=t.clientY-h;i(e,t.clientX,t.clientY,n,o)},g=t=>{if(!x)return;x=!1,u&&e.classList.remove(u),b&&(e.style.transition=b.transition);let n=!1;if(f)try{f(e,t.clientX,t.clientY),n=!0}catch(e){}v(),o(e,t.clientX,t.clientY,t.clientX-c,t.clientY-h),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g),document.removeEventListener("mouseleave",g)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g),document.addEventListener("mouseleave",g)};function v(){y&&y.parentNode&&(y.parentNode.removeChild(y),y=null)}return e.addEventListener("mousedown",C),()=>{e.removeEventListener("mousedown",C),e.style.cursor="",e.style.userSelect="",e.draggable=!1,v(),b&&(e.style.transform=b.transform,e.style.transition=b.transition)}}function O(e,t={}){const{onDragStart:n=()=>{},onDragMove:i=()=>{},onDragEnd:o=()=>{},cursor:s="move",constrainToParent:r=!1,bounds:a=null,rotationFactor:l=0,scaleFactor:c=0}=t;e.style.cursor=s,e.style.userSelect="none";let d=0,h=0;const p=t=>{let r=!0,a=t.clientX,p=t.clientY;const u=e.style.cursor;e.style.cursor="grab"===s?"grabbing":s,n(e,a,p,d,h);const g=t=>{if(!r)return;const n=t.clientX-a,o=t.clientY-p;d+=n,h+=o;let s=[`translate(${d}px, ${h}px)`];if(l>0){const e=d,t=h;if(Math.abs(e)>5||Math.abs(t)>5){const n=Math.atan2(t,e)*(180/Math.PI)*l;s.push(`rotate(${n}deg)`)}}if(c>0){const e=1+Math.sqrt(d*d+h*h)*c*.001;s.push(`scale(${Math.min(e,1.5)})`)}e.style.transform=s.join(" "),i(e,d,h,n,o),a=t.clientX,p=t.clientY,t.preventDefault()},m=t=>{r=!1,e.style.cursor=u,o(e,d,h,d,h),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",m),document.removeEventListener("mouseleave",m)};document.addEventListener("mousemove",g),document.addEventListener("mouseup",m),document.addEventListener("mouseleave",m),t.preventDefault()};return e.addEventListener("mousedown",p),()=>{e.removeEventListener("mousedown",p),e.style.cursor="",e.style.userSelect="",e.style.transform=""}}function T(e="draggable-box",t={}){const{content:n="Drag me!",css:i={},attrs:o={},parent:s=null,cursor:r="grab",rotationFactor:a=0,scaleFactor:l=0,constrainToParent:d=!1,bounds:h=null,onDragStart:p=()=>{},onDragMove:u=()=>{},onDragEnd:g=()=>{},dragActiveClass:m="dragging",dragHoverShadow:f="0 8px 16px rgba(0,0,0,0.2)"}=t,b=c(e,{content:n,css:i,attrs:o,parent:s}),y=O(b,{cursor:r,rotationFactor:a,scaleFactor:l,constrainToParent:d,bounds:h,onDragStart:(e,t,n,i,o)=>{m&&e.classList.add(m),f&&(e.style.boxShadow=f),p(e,t,n,i,o)},onDragMove:(e,t,n,i,o)=>{u(e,t,n,i,o)},onDragEnd:(e,t,n,i,o)=>{m&&e.classList.remove(m),f&&(e.style.boxShadow=""),g(e,t,n,i,o)}});return b.destroyDraggable=y,b}d("draggable-box",{tag:"div",class:"hs-draggable",css:{position:"absolute",width:"100px",height:"100px",backgroundColor:"#3498db",border:"2px solid #2980b9",borderRadius:"8px",cursor:"grab",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",transition:"box-shadow 0.2s ease"}}),d("drag-handle",{tag:"div",class:"hs-drag-handle",css:{position:"absolute",top:"0",left:"0",right:"0",height:"30px",backgroundColor:"rgba(0,0,0,0.1)",borderRadius:"8px 8px 0 0",cursor:"grab",display:"flex",alignItems:"center",justifyContent:"center"}}),d("drop-zone",{tag:"div",class:"hs-drop-zone",css:{position:"relative",minHeight:"100px",border:"2px dashed #bdc3c7",borderRadius:"8px",backgroundColor:"#ecf0f1",display:"flex",alignItems:"center",justifyContent:"center",color:"#7f8c8d",fontSize:"14px",transition:"all 0.3s ease",margin:"10px"}}),d("drop-zone-active",{css:{borderColor:"#3498db",backgroundColor:"#ebf3fd",color:"#2980b9"}}),d("drop-zone-hover",{css:{borderColor:"#27ae60",backgroundColor:"#e8f5e8",color:"#27ae60",transform:"scale(1.02)"}}),d("drop-zone-reject",{css:{borderColor:"#e74c3c",backgroundColor:"#fdf2f2",color:"#c0392b"}});var U={create:T,makeDraggable:O,makeDraggableWithDrop:A,makeDropZone:R},j=Object.freeze({__proto__:null,default:U,draggable:T,makeDraggable:O,makeDraggableWithDrop:A,makeDropZone:R});class P{constructor(e={}){this.config={id:e.id||`matrix-${Date.now()}`,grid:{x:4,y:4,...e.grid},size:{width:400,height:400,...e.size},position:{x:0,y:0,...e.position},spacing:{horizontal:8,vertical:8,external:16,...e.spacing},attach:e.attach||"body",cells:e.cells||{},states:e.states||{},containerStyle:e.containerStyle||{},debug:e.debug||!1,responsive:!1!==e.responsive,autoResize:!1!==e.autoResize,maintainAspectRatio:e.maintainAspectRatio||!1},this.cellsMap=new Map,this.cellStates=new Map,this.cellElements=new Map,this.selectedCells=new Set,this.callbacks={onCellClick:e.onCellClick||null,onCellDoubleClick:e.onCellDoubleClick||null,onCellLongClick:e.onCellLongClick||null,onCellHover:e.onCellHover||null,onCellLeave:e.onCellLeave||null,onCellStateChange:e.onCellStateChange||null,onSelectionChange:e.onSelectionChange||null,onResize:e.onResize||null},this.container=null,this.longClickTimer=null,this.resizeObserver=null,this.isInitialized=!1,this.init()}init(){try{this.createContainer(),this.createCells(),this.setupEventListeners(),this.setupResizeObserver(),this.applyInitialStates(),this.isInitialized=!0,this.config.debug}catch(e){console.error(`❌ Erreur lors de l'initialisation de Matrix "${this.config.id}":`,e)}}createContainer(){const e="string"==typeof this.config.attach?document.querySelector(this.config.attach):this.config.attach;if(!e)throw new Error(`Point d'attachement "${this.config.attach}" non trouvé`);this.container=document.createElement("div"),this.container.id=this.config.id,this.container.className="matrix-container",this.applyContainerStyles(),e.appendChild(this.container)}applyContainerStyles(){const e={position:"absolute",left:`${this.config.position.x}px`,top:`${this.config.position.y}px`,display:"grid",gridTemplateColumns:`repeat(${this.config.grid.x}, 1fr)`,gridTemplateRows:`repeat(${this.config.grid.y}, 1fr)`,gap:`${this.config.spacing.vertical}px ${this.config.spacing.horizontal}px`,background:"#f8f9fa",borderRadius:"12px",border:"1px solid #dee2e6",fontFamily:"system-ui, -apple-system, sans-serif",userSelect:"none",boxSizing:"border-box"};this.config.autoResize?Object.assign(e,{position:"relative",left:"auto",top:"auto",width:"100%",height:"100%",padding:`${this.config.spacing.external}px`}):Object.assign(e,{width:`${this.config.size.width}px`,height:`${this.config.size.height}px`,padding:`${this.config.spacing.external}px`});const t={...e,...this.config.containerStyle};Object.assign(this.container.style,t)}createCells(){for(let e=0;e<this.config.grid.y;e++)for(let t=0;t<this.config.grid.x;t++)this.createCell(t,e)}createCell(e,t){const n=`${e},${t}`,i=this.config.cells[n]||{},o=this.config.cells.default||{},s=i.id||`${this.config.id}-cell-${e}-${t}`,r=document.createElement("div");r.id=s,r.className="matrix-cell",r.tabIndex=0,r.setAttribute("data-x",e),r.setAttribute("data-y",t),r.setAttribute("data-cell-id",s),r.setAttribute("role","button"),r.setAttribute("aria-label",`Cellule ${e}, ${t}`);const a=i.content||o.content||"";r.textContent=a;const l={display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#ffffff",border:"1px solid #dee2e6",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",minHeight:"40px",transition:"all 0.2s ease",userSelect:"none",...o.style,...i.style};Object.assign(r.style,l),this.cellsMap.set(n,{id:s,x:e,y:t,content:a,element:r,config:i}),this.cellElements.set(n,r);const c=new Set(["normal"]);i.states&&i.states.forEach((e=>c.add(e))),this.cellStates.set(n,c),this.config.debug&&r.setAttribute("title",`Cellule (${e}, ${t}) - ID: ${s}`),this.container.appendChild(r)}applyInitialStates(){this.cellStates.forEach(((e,t)=>{e.forEach((e=>{if("normal"!==e&&this.config.states[e]){const[n,i]=t.split(",").map(Number);this.applyCellStateStyle(n,i,e)}}))}))}setupEventListeners(){this.container.addEventListener("click",this.handleCellClick.bind(this)),this.container.addEventListener("dblclick",this.handleCellDoubleClick.bind(this)),this.container.addEventListener("mousedown",this.handleCellMouseDown.bind(this)),this.container.addEventListener("mouseup",this.handleCellMouseUp.bind(this)),this.container.addEventListener("mouseenter",this.handleCellHover.bind(this),!0),this.container.addEventListener("mouseleave",this.handleCellLeave.bind(this),!0),this.container.addEventListener("keydown",this.handleCellKeyDown.bind(this))}handleCellClick(e){const t=this.getCellFromEvent(e);if(!t)return;const{x:n,y:i,id:o,element:s}=t;this.callbacks.onCellClick&&this.callbacks.onCellClick(s,n,i,o,e)}handleCellDoubleClick(e){const t=this.getCellFromEvent(e);if(!t)return;const{x:n,y:i,id:o,element:s}=t;this.callbacks.onCellDoubleClick&&this.callbacks.onCellDoubleClick(s,n,i,o,e)}handleCellMouseDown(e){const t=this.getCellFromEvent(e);if(!t)return;const{x:n,y:i,id:o,element:s}=t;this.longClickTimer=setTimeout((()=>{this.callbacks.onCellLongClick&&this.callbacks.onCellLongClick(s,n,i,o,e)}),500)}handleCellMouseUp(e){this.longClickTimer&&(clearTimeout(this.longClickTimer),this.longClickTimer=null)}handleCellHover(e){const t=this.getCellFromEvent(e);if(!t||!e.target.classList.contains("matrix-cell"))return;const{x:n,y:i,id:o,element:s}=t;this.config.states.hover&&this.applyStylesToElement(s,this.config.states.hover,!0),this.callbacks.onCellHover&&this.callbacks.onCellHover(s,n,i,o,e)}handleCellLeave(e){const t=this.getCellFromEvent(e);if(!t||!e.target.classList.contains("matrix-cell"))return;const{x:n,y:i,id:o,element:s}=t;this.reapplyCellStyles(n,i),this.callbacks.onCellLeave&&this.callbacks.onCellLeave(s,n,i,o,e)}handleCellKeyDown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.handleCellClick(e))}getCellFromEvent(e){const t=e.target.closest(".matrix-cell");if(!t)return null;const n=parseInt(t.getAttribute("data-x")),i=parseInt(t.getAttribute("data-y")),o=`${n},${i}`;return{x:n,y:i,id:t.getAttribute("data-cell-id"),element:t,cellData:this.cellsMap.get(o)}}getCellState(e,t){const n=`${e},${t}`,i=this.cellStates.get(n);if(!i||0===i.size)return null;return Array.from(i).find((e=>"normal"!==e))||"normal"}getCellStates(e,t){const n=`${e},${t}`,i=this.cellStates.get(n);return i?Array.from(i):[]}hasCellState(e,t,n){const i=`${e},${t}`,o=this.cellStates.get(i);return!!o&&o.has(n)}setCellState(e,t,n,i=!0){const o=`${e},${t}`,s=this.cellStates.get(o)||new Set,r=this.cellsMap.get(o);if(!r)return;const a=s.has(n);i&&!a?(s.add(n),this.applyCellStateStyle(e,t,n)):!i&&a&&(s.delete(n),this.removeCellStateStyle(e,t,n)),this.cellStates.set(o,s),"selected"===n&&(i?this.selectedCells.add(o):this.selectedCells.delete(o),this.triggerSelectionChange()),this.callbacks.onCellStateChange&&a!==i&&this.callbacks.onCellStateChange(r.element,e,t,n,i)}addCellState(e,t,n){this.setCellState(e,t,n,!0)}removeCellState(e,t,n){this.setCellState(e,t,n,!1)}toggleCellState(e,t,n){const i=this.hasCellState(e,t,n);return this.setCellState(e,t,n,!i),!i}clearCellStates(e,t){const n=`${e},${t}`;this.cellsMap.get(n)&&(this.resetCellStyle(e,t),this.cellStates.set(n,new Set(["normal"])),this.selectedCells.delete(n),this.triggerSelectionChange())}applyCellStateStyle(e,t,n){const i=`${e},${t}`,o=this.cellsMap.get(i),s=this.config.states[n];o&&s&&this.applyStylesToElement(o.element,s,!0)}removeCellStateStyle(e,t,n){const i=`${e},${t}`,o=this.cellsMap.get(i);if(!o)return;const s=this.config.states[n];s&&Object.keys(s).forEach((e=>{const t=e.replace(/([A-Z])/g,"-$1").toLowerCase();o.element.style.removeProperty(t)})),this.reapplyCellStyles(e,t)}reapplyCellStyles(e,t){const n=`${e},${t}`,i=this.cellsMap.get(n),o=this.cellStates.get(n);i&&o&&(this.resetCellStyle(e,t),o.forEach((e=>{"normal"!==e&&this.config.states[e]&&this.applyStylesToElement(i.element,this.config.states[e],!0)})))}resize(e,t){void 0!==e&&void 0!==t&&(this.config.size.width=e,this.config.size.height=t,this.config.autoResize||(this.container.style.width=`${e}px`,this.container.style.height=`${t}px`)),this.updateCellSizes(),this.config.debug}setAutoResize(e){const t=this.config.autoResize;this.config.autoResize=e,e&&!t?(this.applyContainerStyles(),this.setupResizeObserver()):!e&&t&&(this.disconnectResizeObserver(),this.applyContainerStyles())}disconnectResizeObserver(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}fitToParent(e){const t="string"==typeof e?document.querySelector(e):e;if(!t)return void console.error("❌ Élément parent non trouvé");t.appendChild(this.container),this.setAutoResize(!0);const n=t.getBoundingClientRect();this.handleResize({contentRect:n})}autoSizeCells(e={}){const{minWidth:t=40,minHeight:n=40,padding:i=8,fontSize:o=null}=e;this.cellsMap.forEach(((e,s)=>{const r=e.element,a=r.textContent||"";if(a.length>0){const e=document.createElement("div");e.style.cssText=`\n          position: absolute;\n          top: -9999px;\n          left: -9999px;\n          visibility: hidden;\n          white-space: nowrap;\n          font-family: ${r.style.fontFamily||"inherit"};\n          font-size: ${o||r.style.fontSize||"14px"};\n          font-weight: ${r.style.fontWeight||"inherit"};\n        `,e.textContent=a,document.body.appendChild(e);const s=e.offsetWidth,l=e.offsetHeight;document.body.removeChild(e);const c=Math.max(s+2*i,t),d=Math.max(l+2*i,n);r.style.width=`${c}px`,r.style.height=`${d}px`}})),this.config.debug}fitToContent(e={}){this.autoSizeCells(e);let t=0,n=0;this.cellsMap.forEach((e=>{const i=e.element.getBoundingClientRect();t=Math.max(t,i.width),n=Math.max(n,i.height)}));const i=t*this.config.grid.x+this.config.spacing.horizontal*(this.config.grid.x-1)+2*this.config.spacing.external,o=n*this.config.grid.y+this.config.spacing.vertical*(this.config.grid.y-1)+2*this.config.spacing.external;this.resize(i,o)}setupResizeObserver(){if(!this.config.autoResize||!window.ResizeObserver)return;this.resizeObserver=new ResizeObserver((e=>{for(let t of e)this.handleResize(t)}));const e=this.container.parentElement;e&&this.resizeObserver.observe(e)}handleResize(e){if(!this.config.autoResize)return;const{width:t,height:n}=e.contentRect;this.config.debug,this.config.size.width=t,this.config.size.height=n,this.updateCellSizes(),this.callbacks.onResize&&this.callbacks.onResize(t,n)}updateCellSizes(){if(!this.config.autoResize)return;const e=this.container.getBoundingClientRect(),t=e.width-2*this.config.spacing.external,n=e.height-2*this.config.spacing.external,i=(t-this.config.spacing.horizontal*(this.config.grid.x-1))/this.config.grid.x,o=(n-this.config.spacing.vertical*(this.config.grid.y-1))/this.config.grid.y;if(this.config.maintainAspectRatio){const e=Math.min(i,o);this.cellsMap.forEach((t=>{t.element.style.width=`${e}px`,t.element.style.height=`${e}px`}))}this.config.debug}applyStylesToElement(e,t,n=!1){Object.entries(t).forEach((([t,i])=>{if("string"==typeof i||"number"==typeof i){const o=t.replace(/([A-Z])/g,"-$1").toLowerCase();e.style.setProperty(o,String(i),n?"important":"")}}))}camelToKebab(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}getCellsByState(e){const t=[];return this.cellStates.forEach(((n,i)=>{if(n.has(e)){const[e,n]=i.split(",").map(Number),o=this.cellsMap.get(i);t.push({x:e,y:n,id:o.id,element:o.element})}})),t}getCellsWithAnyState(e){const t=[];return this.cellStates.forEach(((n,i)=>{if(e.some((e=>n.has(e)))){const[e,o]=i.split(",").map(Number),s=this.cellsMap.get(i);t.push({x:e,y:o,id:s.id,element:s.element,states:Array.from(n)})}})),t}getCellsWithAllStates(e){const t=[];return this.cellStates.forEach(((n,i)=>{if(e.every((e=>n.has(e)))){const[e,o]=i.split(",").map(Number),s=this.cellsMap.get(i);t.push({x:e,y:o,id:s.id,element:s.element,states:Array.from(n)})}})),t}getStateCount(e){let t=0;return this.cellStates.forEach((n=>{n.has(e)&&t++})),t}getAllStates(){const e=new Set;return this.cellStates.forEach((t=>{t.forEach((t=>e.add(t)))})),Array.from(e)}getStateDistribution(){const e={};return this.cellStates.forEach((t=>{t.forEach((t=>{e[t]=(e[t]||0)+1}))})),e}findCells(e){const t=[];return this.cellsMap.forEach(((n,i)=>{const[o,s]=i.split(",").map(Number);let r=!0;if(e.state&&!this.hasCellState(o,s,e.state)&&(r=!1),void 0!==e.hasContent){const t=n.content&&n.content.trim().length>0;e.hasContent!==t&&(r=!1)}e.position&&(e.position.x&&(void 0!==e.position.x.min&&o<e.position.x.min&&(r=!1),void 0!==e.position.x.max&&o>e.position.x.max&&(r=!1)),e.position.y&&(void 0!==e.position.y.min&&s<e.position.y.min&&(r=!1),void 0!==e.position.y.max&&s>e.position.y.max&&(r=!1))),r&&t.push({x:o,y:s,id:n.id,element:n.element,content:n.content,states:this.getCellStates(o,s)})})),t}getCellsInRange(e,t,n,i){const o=[],s=Math.min(e,n),r=Math.max(e,n),a=Math.min(t,i),l=Math.max(t,i);for(let e=a;e<=l;e++)for(let t=s;t<=r;t++){const n=`${t},${e}`,i=this.cellsMap.get(n);i&&o.push({x:t,y:e,id:i.id,element:i.element})}return o}getCellsInRow(e){const t=[];for(let n=0;n<this.config.grid.x;n++){const i=`${n},${e}`,o=this.cellsMap.get(i);o&&t.push({x:n,y:e,id:o.id,element:o.element})}return t}getCellsInColumn(e){const t=[];for(let n=0;n<this.config.grid.y;n++){const i=`${e},${n}`,o=this.cellsMap.get(i);o&&t.push({x:e,y:n,id:o.id,element:o.element})}return t}compareCellStates(e,t,n,i){const o=new Set(this.getCellStates(e,t)),s=new Set(this.getCellStates(n,i));return{same:[...o].every((e=>s.has(e)))&&[...s].every((e=>o.has(e))),common:[...o].filter((e=>s.has(e))),different1:[...o].filter((e=>!s.has(e))),different2:[...s].filter((e=>!o.has(e)))}}findSimilarCells(e,t){const n=new Set(this.getCellStates(e,t)),i=[];return this.cellStates.forEach(((o,s)=>{const[r,a]=s.split(",").map(Number);if(r===e&&a===t)return;if(o.size===n.size&&[...o].every((e=>n.has(e)))){const e=this.cellsMap.get(s);i.push({x:r,y:a,id:e.id,element:e.element})}})),i}groupCellsByState(){const e={};return this.cellStates.forEach(((t,n)=>{const[i,o]=n.split(",").map(Number),s=this.cellsMap.get(n);t.forEach((t=>{e[t]||(e[t]=[]),e[t].push({x:i,y:o,id:s.id,element:s.element})}))})),e}getCellId(e,t){const n=`${e},${t}`,i=this.cellsMap.get(n);return i?i.id:null}getCellContent(e,t){const n=`${e},${t}`,i=this.cellsMap.get(n);return i?i.content:null}setCellContent(e,t,n){const i=`${e},${t}`,o=this.cellsMap.get(i);o&&(o.content=n,o.element.textContent=n)}getCellStyle(e,t){const n=`${e},${t}`,i=this.cellsMap.get(n);return i?i.element.style:null}setCellStyle(e,t,n){const i=`${e},${t}`,o=this.cellsMap.get(i);o&&Object.assign(o.element.style,n)}resetCellStyle(e,t){const n=`${e},${t}`,i=this.cellsMap.get(n);if(i){const e=i.config,t={...{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#ffffff",border:"1px solid #dee2e6",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",minHeight:"40px",transition:"all 0.2s ease",userSelect:"none"},...(this.config.cells.default||{}).style,...e.style};i.element.removeAttribute("style"),this.applyStylesToElement(i.element,t,!1)}}getSelectedCells(){const e=[];return this.selectedCells.forEach((t=>{const[n,i]=t.split(",").map(Number),o=this.cellsMap.get(t);e.push({x:n,y:i,id:o.id,element:o.element})})),e}clearSelection(){Array.from(this.selectedCells).forEach((e=>{const[t,n]=e.split(",").map(Number);this.removeCellState(t,n,"selected")}))}triggerSelectionChange(){this.callbacks.onSelectionChange&&this.callbacks.onSelectionChange(this.getSelectedCells())}getTotalCells(){return this.config.grid.x*this.config.grid.y}getCell(e,t){const n=`${e},${t}`,i=this.cellsMap.get(n);return i?i.element:null}getCellData(e,t){const n=`${e},${t}`;return this.cellsMap.get(n)}destroy(){try{this.longClickTimer&&(clearTimeout(this.longClickTimer),this.longClickTimer=null),this.disconnectResizeObserver(),this.container&&(this.container.removeEventListener("click",this.handleCellClick),this.container.removeEventListener("dblclick",this.handleCellDoubleClick),this.container.removeEventListener("mousedown",this.handleCellMouseDown),this.container.removeEventListener("mouseup",this.handleCellMouseUp),this.container.removeEventListener("mouseenter",this.handleCellHover),this.container.removeEventListener("mouseleave",this.handleCellLeave),this.container.removeEventListener("keydown",this.handleCellKeyDown),this.container.parentNode&&this.container.parentNode.removeChild(this.container)),this.cellsMap.clear(),this.cellStates.clear(),this.cellElements.clear(),this.selectedCells.clear(),this.callbacks={}}catch(e){console.error(`❌ Erreur lors de la destruction de Matrix "${this.config.id}":`,e)}}}var _=Object.freeze({__proto__:null,createAutoSizedMatrix:function(e={}){const t=new P({autoResize:!1,...e});return setTimeout((()=>{t.fitToContent()}),0),t},createMatrix:function(e){return new P(e)},createResponsiveMatrix:function(e,t={}){const n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`Élément parent "${e}" non trouvé`);return new P({autoResize:!0,maintainAspectRatio:!1,attach:n,...t})},default:P});var H=Object.freeze({__proto__:null,default:class{constructor(e={}){this.config={id:e.id||`menu-${Date.now()}`,position:{x:0,y:0,...e.position},size:{width:"auto",height:"auto",...e.size},attach:e.attach||"body",layout:{direction:"horizontal",wrap:!1,justify:"flex-start",align:"center",gap:"8px",...e.layout},content:e.content||[],styling:{container:{display:"flex",position:"relative",backgroundColor:"#ffffff",border:"1px solid #e0e0e0",borderRadius:"8px",padding:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontFamily:"system-ui, -apple-system, sans-serif",...e.styling?.container},item:{display:"flex",alignItems:"center",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s ease",textDecoration:"none",color:"#333333",fontSize:"14px",fontWeight:"400",userSelect:"none",...e.styling?.item},group:{display:"flex",alignItems:"center",gap:"8px",...e.styling?.group},dropdown:{position:"absolute",top:"100%",left:"0",minWidth:"200px",backgroundColor:"#ffffff",border:"1px solid #e0e0e0",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:"4px",zIndex:"1000",opacity:"0",visibility:"hidden",transform:"translateY(-10px)",transition:"all 0.3s ease",...e.styling?.dropdown},states:{hover:{backgroundColor:"#f8f9fa",transform:"translateY(-1px)",...e.styling?.states?.hover},active:{backgroundColor:"#007bff",color:"#ffffff",...e.styling?.states?.active},focus:{outline:"2px solid #007bff",outlineOffset:"2px",...e.styling?.states?.focus},disabled:{opacity:"0.5",cursor:"not-allowed",...e.styling?.states?.disabled}},...e.styling},responsive:{enabled:e.responsive?.enabled??!0,breakpoints:{mobile:{maxWidth:"768px",...e.responsive?.breakpoints?.mobile},tablet:{maxWidth:"1024px",...e.responsive?.breakpoints?.tablet},...e.responsive?.breakpoints},...e.responsive},options:{closeOnOutsideClick:e.options?.closeOnOutsideClick??!0,closeOnItemClick:e.options?.closeOnItemClick??!0,animation:e.options?.animation??"fade",keyboard:e.options?.keyboard??!0,...e.options},debug:e.debug||!1},this.itemsMap=new Map,this.groupsMap=new Map,this.dropdownsMap=new Map,this.selectedItems=new Set,this.activeDropdown=null,this.callbacks={onItemClick:e.onItemClick||null,onItemHover:e.onItemHover||null,onDropdownOpen:e.onDropdownOpen||null,onDropdownClose:e.onDropdownClose||null,onResponsiveChange:e.onResponsiveChange||null},this.createContainer(),this.createMenu(),this.setupEventListeners(),this.setupResponsive(),this.config.debug}createContainer(){this.container=document.createElement("nav"),this.container.id=this.config.id,this.container.className="professional-menu";const e=document.querySelector(this.config.attach);e?(this.applyContainerStyles(),e.appendChild(this.container)):console.error(`❌ Point d'attachement "${this.config.attach}" introuvable`)}applyContainerStyles(){const e={};void 0===this.config.position.x&&void 0===this.config.position.y||(e.position="absolute",void 0!==this.config.position.x&&(e.left=`${this.config.position.x}px`),void 0!==this.config.position.y&&(e.top=`${this.config.position.y}px`));const t={};"auto"!==this.config.size.width&&(t.width=`${this.config.size.width}px`),"auto"!==this.config.size.height&&(t.height=`${this.config.size.height}px`);const n={flexDirection:"vertical"===this.config.layout.direction?"column":"row",flexWrap:this.config.layout.wrap?"wrap":"nowrap",justifyContent:this.config.layout.justify,alignItems:this.config.layout.align,gap:this.config.layout.gap},i={...this.config.styling.container,...e,...t,...n};Object.assign(this.container.style,i)}createMenu(){this.config.content.forEach(((e,t)=>{const n=this.createContentElement(e,t);n&&this.container.appendChild(n)}))}createContentElement(e,t){switch(e.type){case"item":return this.createMenuItem(e,t);case"group":return this.createMenuGroup(e,t);case"separator":return this.createSeparator(e,t);default:return console.warn(`⚠️ Type de contenu inconnu: ${e.type}`),null}}createMenuItem(e,t){const n=document.createElement(e.href?"a":"div");return n.id=e.id||`menu-item-${t}`,n.className="menu-item",e.href&&(n.href=e.href),e.content&&(e.content.html?n.innerHTML=e.content.html:e.content.text&&(n.textContent=e.content.text)),Object.assign(n.style,this.config.styling.item),e.style&&Object.assign(n.style,e.style),"end"===e.position?n.style.marginLeft="auto":"center"===e.position&&(n.style.margin="0 auto"),e.dropdown&&this.createDropdown(n,e.dropdown),this.itemsMap.set(n.id,{...e,element:n,states:e.states||{}}),n}createMenuGroup(e,t){const n=document.createElement("div");if(n.id=e.id||`menu-group-${t}`,n.className="menu-group",Object.assign(n.style,this.config.styling.group),e.layout){const t={flexDirection:"vertical"===e.layout.direction?"column":"row",gap:e.layout.gap||this.config.layout.gap,justifyContent:e.layout.justify||"flex-start",alignItems:e.layout.align||"center"};Object.assign(n.style,t)}return e.style&&Object.assign(n.style,e.style),e.items&&e.items.forEach(((e,i)=>{const o=this.createMenuItem(e,`${t}-${i}`);o&&n.appendChild(o)})),this.groupsMap.set(n.id,{...e,element:n}),n}createSeparator(e,t){const n=document.createElement("div");n.id=e.id||`menu-separator-${t}`,n.className="menu-separator";const i={width:"vertical"===this.config.layout.direction?"100%":"1px",height:"vertical"===this.config.layout.direction?"1px":"20px",backgroundColor:"#e0e0e0",margin:"0 8px"};return Object.assign(n.style,i),e.style&&Object.assign(n.style,e.style),n}createDropdown(e,t){const n=document.createElement("div");if(n.id=`${e.id}-dropdown`,n.className="menu-dropdown",Object.assign(n.style,this.config.styling.dropdown),t.position){const e=t.position.split("-");e.includes("top")&&(n.style.bottom="100%"),e.includes("right")&&(n.style.left="auto",n.style.right="0")}return t.items&&t.items.forEach(((e,t)=>{const i=this.createMenuItem(e,`dropdown-${t}`);i&&(i.style.width="100%",i.style.margin="2px 0",n.appendChild(i))})),e.style.position="relative",e.appendChild(n),this.dropdownsMap.set(n.id,{...t,element:n,parent:e}),n}setupEventListeners(){this.container.addEventListener("click",(e=>{this.handleItemClick(e)})),this.container.addEventListener("mouseover",(e=>{this.handleItemHover(e)})),this.container.addEventListener("mouseout",(e=>{this.handleItemLeave(e)})),this.config.options.keyboard&&this.container.addEventListener("keydown",(e=>{this.handleKeyboard(e)})),this.config.options.closeOnOutsideClick&&document.addEventListener("click",(e=>{this.container.contains(e.target)||this.closeAllDropdowns()}))}handleItemClick(e){const t=e.target.closest(".menu-item");if(!t)return;const n=this.itemsMap.get(t.id);if(n){if(n.dropdown)return e.preventDefault(),void this.toggleDropdown(t);this.config.options.closeOnItemClick&&this.closeAllDropdowns(),this.setActiveItem(t),this.callbacks.onItemClick&&this.callbacks.onItemClick(n,e),n.onClick&&n.onClick(e)}}handleItemHover(e){const t=e.target.closest(".menu-item");if(!t)return;const n=this.itemsMap.get(t.id);n&&(this.applyItemState(t,"hover"),this.callbacks.onItemHover&&this.callbacks.onItemHover(n,e))}handleItemLeave(e){const t=e.target.closest(".menu-item");t&&this.removeItemState(t,"hover")}handleKeyboard(e){switch(e.key){case"Escape":this.closeAllDropdowns();break;case"ArrowDown":case"ArrowUp":this.navigateItems("ArrowDown"===e.key?1:-1),e.preventDefault();break;case"Enter":case" ":const t=document.activeElement;t&&t.classList.contains("menu-item")&&(t.click(),e.preventDefault())}}applyItemState(e,t){const n=this.itemsMap.get(e.id);if(!n)return;const i=this.config.styling.states[t];i&&Object.assign(e.style,i);const o=n.states[t];o&&Object.assign(e.style,o)}removeItemState(e,t){const n=this.itemsMap.get(e.id);n&&(Object.assign(e.style,this.config.styling.item),n.style&&Object.assign(e.style,n.style))}setActiveItem(e){this.itemsMap.forEach(((t,n)=>{n!==e.id&&this.removeItemState(t.element,"active")})),this.applyItemState(e,"active")}setupResponsive(){this.config.responsive.enabled&&(this.resizeObserver=new ResizeObserver((()=>{this.handleResponsiveChange()})),this.resizeObserver.observe(document.body),this.handleResponsiveChange())}handleResponsiveChange(){const e=window.innerWidth,t=this.config.responsive.breakpoints;let n="desktop";e<=t.mobile?.maxWidth?n="mobile":e<=t.tablet?.maxWidth&&(n="tablet"),this.applyResponsiveStyles(n),this.callbacks.onResponsiveChange&&this.callbacks.onResponsiveChange(n,e)}applyResponsiveStyles(e){const t=this.config.responsive.breakpoints[e];t&&(t.orientation&&(this.container.style.flexDirection="vertical"===t.orientation?"column":"row"),t.collapse&&this.createMobileToggle())}createMobileToggle(){this.mobileToggle||(this.mobileToggle=document.createElement("button"),this.mobileToggle.innerHTML="☰",this.mobileToggle.className="menu-mobile-toggle",this.mobileToggle.style.cssText="\n        display: none;\n        background: none;\n        border: none;\n        font-size: 20px;\n        cursor: pointer;\n        padding: 8px;\n      ",this.mobileToggle.addEventListener("click",(()=>{this.toggleMobileMenu()})),this.container.parentElement.insertBefore(this.mobileToggle,this.container)),window.innerWidth<=this.config.responsive.breakpoints.mobile?.maxWidth?(this.mobileToggle.style.display="block",this.container.style.display="none"):(this.mobileToggle.style.display="none",this.container.style.display="flex")}toggleDropdown(e){const t=`${e.id}-dropdown`,n=document.getElementById(t);if(!n)return;"1"===n.style.opacity?this.closeDropdown(n):(this.closeAllDropdowns(),this.openDropdown(n))}openDropdown(e){e.style.opacity="1",e.style.visibility="visible",e.style.transform="translateY(0)",this.activeDropdown=e,this.callbacks.onDropdownOpen&&this.callbacks.onDropdownOpen(e)}closeDropdown(e){e.style.opacity="0",e.style.visibility="hidden",e.style.transform="translateY(-10px)",this.activeDropdown===e&&(this.activeDropdown=null),this.callbacks.onDropdownClose&&this.callbacks.onDropdownClose(e)}closeAllDropdowns(){this.dropdownsMap.forEach((e=>{this.closeDropdown(e.element)}))}addItem(e,t=null){const n=this.createMenuItem(e,Date.now());if(t){const e=document.getElementById(t);e&&e.appendChild(n)}else this.container.appendChild(n);return n.id}removeItem(e){const t=document.getElementById(e);t&&(t.remove(),this.itemsMap.delete(e))}updateItem(e,t){const n=this.itemsMap.get(e);if(!n)return;const i=n.element;t.content&&(t.content.html?i.innerHTML=t.content.html:t.content.text&&(i.textContent=t.content.text)),t.style&&Object.assign(i.style,t.style),Object.assign(n,t)}toggleMobileMenu(){const e="none"!==this.container.style.display;this.container.style.display=e?"none":"flex",this.mobileToggle&&(this.mobileToggle.innerHTML=e?"☰":"✕")}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.mobileToggle&&this.mobileToggle.remove(),this.container.remove()}navigateItems(e){const t=Array.from(this.container.querySelectorAll(".menu-item"));let n=t.findIndex((e=>e===document.activeElement))+e;n<0&&(n=t.length-1),n>=t.length&&(n=0),t[n]&&t[n].focus()}getActiveItem(){return Array.from(this.itemsMap.values()).find((e=>e.element.style.backgroundColor===this.config.styling.states.active.backgroundColor))}getAllItems(){return Array.from(this.itemsMap.values())}getDropdownState(e){const t=`${e}-dropdown`,n=document.getElementById(t);return!!n&&"1"===n.style.opacity}}});d("slider-container",{tag:"div",class:"hs-slider",css:{position:"relative",display:"inline-block",userSelect:"none",touchAction:"none"}}),d("slider-track",{tag:"div",class:"hs-slider-track",css:{position:"absolute",backgroundColor:"#e0e0e0",borderRadius:"4px",overflow:"hidden",zIndex:"1",boxSizing:"border-box"}}),d("slider-progression",{tag:"div",class:"hs-slider-progression",css:{position:"absolute",backgroundColor:"#007bff",borderRadius:"0",zIndex:"2"}}),d("slider-handle",{tag:"div",class:"hs-slider-handle",css:{position:"absolute",backgroundColor:"#fff",border:"2px solid #007bff",borderRadius:"50%",cursor:"pointer",zIndex:"20",boxShadow:"0 4px 8px rgba(0,0,0,0.15)"}}),d("slider-label",{tag:"div",class:"hs-slider-label",css:{position:"absolute",fontSize:"12px",fontFamily:"system-ui, sans-serif",color:"#666",whiteSpace:"nowrap"}}),d("slider-tick",{tag:"div",class:"hs-slider-tick",css:{position:"absolute",backgroundColor:"#ccc",pointerEvents:"none"}});const B={horizontal:{container:{width:"200px",height:"20px"},track:{width:"100%",height:"4px",top:"50%",transform:"translateY(-50%)"},progression:{height:"100%",left:"0",top:"0",borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px"},handle:{width:"16px",height:"16px",top:"50%"},label:{top:"25px",transform:"translateX(-50%)"}},vertical:{container:{width:"20px",height:"200px"},track:{width:"4px",height:"100%",left:"50%",transform:"translateX(-50%)"},progression:{width:"100%",bottom:"0",left:"0",borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px"},handle:{width:"16px",height:"16px",left:"50%"},label:{left:"25px",transform:"translateY(-50%)"}},circular:{container:{width:"120px",height:"120px"},track:{width:"100%",height:"100%",borderRadius:"50%",border:"4px solid #e0e0e0"},progression:{display:"none"},handle:{width:"20px",height:"20px"},label:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}},N={sm:{scale:.8},md:{scale:1},lg:{scale:1.2},xl:{scale:1.5}},W={materialHorizontal:(e={})=>({...e,type:"horizontal",skin:{container:{width:"250px",height:"24px",padding:"12px 0"},track:{width:"100%",height:"4px",top:"10px",backgroundColor:"#e0e0e0",borderRadius:"2px"},progression:{height:"100%",backgroundColor:"#1976d2",borderRadius:"2px"},handle:{width:"20px",height:"20px",top:"-8px",backgroundColor:"#1976d2",border:"none",boxShadow:"0 3px 6px rgba(25, 118, 210, 0.3)"},label:{top:"30px",fontSize:"14px",fontWeight:"500",color:"#1976d2"},...e.skin||{}}}),materialVertical:(e={})=>({...e,type:"vertical",skin:{container:{width:"24px",height:"250px",padding:"0 12px"},track:{width:"4px",height:"100%",left:"10px",backgroundColor:"#e0e0e0",borderRadius:"2px"},progression:{width:"100%",backgroundColor:"#1976d2",borderRadius:"2px"},handle:{width:"20px",height:"20px",left:"-8px",backgroundColor:"#1976d2",border:"none",boxShadow:"0 3px 6px rgba(25, 118, 210, 0.3)"},label:{left:"30px",fontSize:"14px",fontWeight:"500",color:"#1976d2"},...e.skin||{}}}),materialCircular:(e={})=>({...e,type:"circular",skin:{container:{width:"140px",height:"140px",padding:"10px"},track:{width:"100%",height:"100%",borderRadius:"50%",border:"6px solid #e0e0e0",backgroundColor:"transparent"},handle:{width:"24px",height:"24px",backgroundColor:"#1976d2",border:"3px solid #fff",boxShadow:"0 4px 8px rgba(25, 118, 210, 0.3)"},label:{fontSize:"18px",fontWeight:"bold",color:"#1976d2"},...e.skin||{}}})},q=(e={})=>{const{type:t="horizontal",min:n=0,max:i=100,value:o=50,step:s=1,onChange:r,onInput:a,skin:l={},id:d,disabled:h=!1,showLabel:p=!0,showTicks:u=!1,ticks:g=[],size:m="md",radius:f,handleOffset:b=0,dragMin:y=null,dragMax:x=null,...C}=e,v=d||`slider_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,w=Math.max(n,Math.min(i,o)),S="circular"===t;let k={...B[t]?.container||{},...N[m]||{}},E={...B[t]?.track||{}},$={...B[t]?.progression||{}},M={...B[t]?.handle||{}},L={...B[t]?.label||{}};if(S&&f){const e=2*f;k.width=`${e}px`,k.height=`${e}px`}l.container&&(k={...k,...l.container}),l.track&&(E={...E,...l.track}),l.progression&&($={...$,...l.progression}),l.handle&&(M={...M,...l.handle}),l.label&&(L={...L,...l.label}),h&&(k.opacity="0.6",k.pointerEvents="none");const I=c("slider-container",{id:v,css:k,...C}),D=c("slider-track",{id:`${v}_track`,css:E});let z;S&&D.$({css:{width:"100%",height:"100%",top:"0",left:"0"}}),S||(z=c("slider-progression",{id:`${v}_progression`,css:$}),D.appendChild(z));const R=c("slider-handle",{id:`${v}_handle`,css:M});let A;p&&(A=c("slider-label",{id:`${v}_label`,text:w.toString(),css:L})),u&&g.length>0&&g.forEach(((e,o)=>{const s=(e-n)/(i-n)*100,r=c("slider-tick",{id:`${v}_tick_${o}`,css:{...l.tick||{},..."horizontal"===t?{left:`${s}%`,top:"12px",width:"2px",height:"6px"}:{top:100-s+"%",left:"12px",width:"6px",height:"2px"}}});I.appendChild(r)})),I.appendChild(D),!S&&z&&D.appendChild(z),I.appendChild(R),A&&I.appendChild(A);let O=!1,T=w,U=b;const j=e=>{const o=Math.max(n,Math.min(i,e));if(S){const e=(o-n)/(i-n)*100;let t=0;null!==y||null!==x?o>=_&&o<=H?t=(o-_)/(H-_)*100:o>H&&(t=100):t=e;const s=(e/100*360-90)*Math.PI/180,r=window.getComputedStyle(D),a=50-(parseFloat(r.borderWidth)||parseFloat(r.borderTopWidth)||6)/I.offsetWidth*100+U,c=50+a*Math.cos(s),d=50+a*Math.sin(s);if(R.$({css:{left:`${c}%`,top:`${d}%`,transform:"translate(-50%, -50%)",zIndex:"15"}}),D.querySelector("svg")){const e=D.querySelector(".progress-circle");if(e){const o=42,s=2*Math.PI*o;if(null!==y||null!==x){const o=t/100*(s*((H-_)/(i-n))),r=s*((_-n)/(i-n));e.style.strokeDasharray=`${o} ${s-o}`,e.style.strokeDashoffset=-r}else{const n=s-t/100*s;e.style.strokeDasharray=s,e.style.strokeDashoffset=n}}}else{const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("viewBox","0 0 100 100"),e.style.cssText="\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          transform: rotate(-90deg);\n          pointer-events: none;\n          z-index: 2;\n        ";const o=42,s=2*Math.PI*o,r=document.createElementNS("http://www.w3.org/2000/svg","circle");r.style.cssText="\n          fill: none;\n          stroke: #e0e0e0;\n          stroke-width: 6;\n          opacity: 0.3;\n        ",r.setAttribute("cx","50"),r.setAttribute("cy","50"),r.setAttribute("r",o.toString());const a=l.progression||{},c=document.createElementNS("http://www.w3.org/2000/svg","circle");if(c.classList.add("progress-circle"),null!==y||null!==x){const e=t/100*(s*((H-_)/(i-n))),o=s*((_-n)/(i-n));c.style.cssText=`\n            fill: none;\n            stroke: ${a.stroke||$.backgroundColor||"#007bff"};\n            stroke-width: ${a.strokeWidth||"6"};\n            stroke-dasharray: ${e} ${s-e};\n            stroke-dashoffset: ${-o};\n            stroke-linecap: ${a.strokeLinecap||"butt"};\n            opacity: ${a.opacity||"1"};\n          `}else c.style.cssText=`\n            fill: none;\n            stroke: ${a.stroke||$.backgroundColor||"#007bff"};\n            stroke-width: ${a.strokeWidth||"6"};\n            stroke-dasharray: ${s};\n            stroke-dashoffset: ${s-t/100*s};\n            stroke-linecap: ${a.strokeLinecap||"butt"};\n            opacity: ${a.opacity||"1"};\n          `;c.setAttribute("cx","50"),c.setAttribute("cy","50"),c.setAttribute("r",o.toString()),e.appendChild(r),e.appendChild(c),D.appendChild(e)}}else{const e=(o-n)/(i-n)*100;"vertical"===t?(R.$({css:{top:100-e+"%",transform:"translate(-50%, -50%)"}}),z&&z.$({css:{height:`${e}%`}})):(R.$({css:{left:`${e}%`,transform:"translate(-50%, -50%)"}}),z&&z.$({css:{width:`${e}%`}}))}A&&A.$({text:Math.round(o).toString()}),T=o},P=(e,o)=>{if(S){const t=I.getBoundingClientRect(),s=e-(t.left+t.width/2),r=o-(t.top+t.height/2);let a=Math.atan2(r,s)*(180/Math.PI);a+=90,a<0&&(a+=360);const l=n+a/360*(i-n);return S?Math.max(_,Math.min(H,l)):l}if("vertical"===t){const e=D.getBoundingClientRect(),t=1-(o-e.top)/e.height;return n+Math.max(0,Math.min(1,t))*(i-n)}{const t=D.getBoundingClientRect(),o=(e-t.left)/t.width;return n+Math.max(0,Math.min(1,o))*(i-n)}},_=null!==y?y:n,H=null!==x?x:i;_<n&&console.warn(`dragMin (${_}) ne peut pas être inférieur à min (${n})`),H>i&&console.warn(`dragMax (${H}) ne peut pas être supérieur à max (${i})`);const W=e=>{if(h)return;O=!0;const t=P(e.clientX,e.clientY),n=Math.round(t/s)*s;j(n),a&&a(T),document.addEventListener("mousemove",q),document.addEventListener("mouseup",F),e.preventDefault()},q=e=>{if(!O)return;const t=P(e.clientX,e.clientY),n=Math.round(t/s)*s;j(n),a&&a(T),e.preventDefault()},F=()=>{O&&(O=!1,r&&r(T),document.removeEventListener("mousemove",q),document.removeEventListener("mouseup",F))},Y=e=>{if(h)return;const t=e.touches[0];W({clientX:t.clientX,clientY:t.clientY,preventDefault:()=>e.preventDefault()})};return R.addEventListener("mousedown",W),D.addEventListener("mousedown",W),R.addEventListener("touchstart",Y,{passive:!1}),D.addEventListener("touchstart",Y,{passive:!1}),document.addEventListener("touchmove",(e=>{if(!O)return;const t=e.touches[0];q({clientX:t.clientX,clientY:t.clientY,preventDefault:()=>e.preventDefault()})}),{passive:!1}),document.addEventListener("touchend",(()=>{F()})),j(w),I.setValue=e=>(j(e),r&&r(T),I),I.getValue=()=>T,I.setRange=(e,t)=>(n=e,i=t,j(T),I),I.setDisabled=e=>(h=e,I.$({css:{opacity:e?"0.6":"1",pointerEvents:e?"none":"auto"}}),I),I.setHandleOffset=e=>(S&&(U=e,j(T)),I),I.getHandleOffset=()=>U,I},F=e=>q({...e,type:"horizontal"}),Y=e=>q({...e,type:"vertical"}),X=e=>q({...e,type:"circular"}),Z=e=>q(W.materialHorizontal(e)),V=e=>q(W.materialVertical(e)),K=e=>q(W.materialCircular(e));var J={create:q,horizontal:F,vertical:Y,circular:X,materialHorizontal:Z,materialVertical:V,materialCircular:K},G=Object.freeze({__proto__:null,createCircularSlider:X,createHorizontalSlider:F,createSlider:q,createVerticalSlider:Y,default:J,materialCircular:K,materialHorizontal:Z,materialVertical:V,sliderPresets:W,sliderSizes:N,sliderVariants:B});var Q=Object.freeze({__proto__:null,default:class{constructor(e={}){this.config={id:e.id||`table-${Date.now()}`,position:{x:0,y:0,...e.position},size:{width:800,height:600,...e.size},attach:e.attach||"body",columns:e.columns||[],rows:e.rows||[],styling:{cellPadding:e.styling?.cellPadding??12,cellMargin:e.styling?.cellMargin??2,rowHeight:e.styling?.rowHeight??40,borderSpacing:e.styling?.borderSpacing??0,headerStyle:{backgroundColor:"#343a40",color:"#ffffff",fontWeight:"600",fontSize:"14px",padding:"12px",...e.styling?.headerStyle},cellStyle:{backgroundColor:"#ffffff",color:"#212529",fontSize:"13px",border:"1px solid #dee2e6",padding:"8px 12px",...e.styling?.cellStyle},alternateRowStyle:{backgroundColor:"#f8f9fa",...e.styling?.alternateRowStyle},states:{hover:{backgroundColor:"#e9ecef",cursor:"pointer",...e.styling?.states?.hover},selected:{backgroundColor:"#007bff",color:"#ffffff",...e.styling?.states?.selected},...e.styling?.states},...e.styling},options:{sortable:e.options?.sortable??!0,selectable:e.options?.selectable??!0,multiSelect:e.options?.multiSelect??!1,resizableColumns:e.options?.resizableColumns??!0,addRows:e.options?.addRows??!0,deleteRows:e.options?.deleteRows??!0,addColumns:e.options?.addColumns??!0,deleteColumns:e.options?.deleteColumns??!0,...e.options},debug:e.debug||!1},this.cellsMap=new Map,this.rowsMap=new Map,this.columnsMap=new Map,this.selectedRows=new Set,this.selectedCells=new Set,this.sortConfig={column:null,direction:"asc"},this.callbacks={onCellClick:e.onCellClick||null,onCellEdit:e.onCellEdit||null,onRowSelect:e.onRowSelect||null,onSort:e.onSort||null,onRowAdd:e.onRowAdd||null,onRowDelete:e.onRowDelete||null,onColumnAdd:e.onColumnAdd||null,onColumnDelete:e.onColumnDelete||null},this.container=null,this.tableElement=null,this.isInitialized=!1,this.init()}init(){try{this.createContainer(),this.createTable(),this.setupEventListeners(),this.isInitialized=!0,this.config.debug}catch(e){console.error(`❌ Erreur lors de l'initialisation de Table "${this.config.id}":`,e)}}createContainer(){const e="string"==typeof this.config.attach?document.querySelector(this.config.attach):this.config.attach;if(!e)throw new Error(`Point d'attachement "${this.config.attach}" non trouvé`);this.container=document.createElement("div"),this.container.id=this.config.id,this.container.className="table-container",this.applyContainerStyles(),e.appendChild(this.container)}applyContainerStyles(){const e={position:"absolute",left:`${this.config.position.x}px`,top:`${this.config.position.y}px`,width:`${this.config.size.width}px`,height:`${this.config.size.height}px`,background:"#ffffff",border:"1px solid #dee2e6",borderRadius:"8px",fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',display:"flex",flexDirection:"column",overflow:"hidden"};Object.assign(this.container.style,e)}createTable(){this.headerContainer=document.createElement("div"),this.headerContainer.className="table-header-container",this.headerContainer.style.cssText=`\n      display: flex;\n      flex-shrink: 0;\n      border-bottom: 2px solid #dee2e6;\n      background: ${this.config.styling.headerStyle.backgroundColor||"#343a40"};\n    `,this.bodyContainer=document.createElement("div"),this.bodyContainer.className="table-body-container",this.bodyContainer.style.cssText="\n      flex: 1;\n      overflow-y: auto;\n      overflow-x: hidden;\n      max-height: calc(100% - 50px);\n    ",this.createHeader(),this.createBody(),this.container.appendChild(this.headerContainer),this.container.appendChild(this.bodyContainer)}createHeader(){this.config.columns.forEach((e=>{const t=document.createElement("div");t.id=`header-${e.id}`,t.className="table-header-cell",t.textContent=e.header||e.id,t.style.cssText=`\n        width: ${e.width||100}px;\n        min-width: ${e.width||100}px;\n        max-width: ${e.width||100}px;\n        padding: ${this.config.styling.headerStyle.padding||"12px"};\n        font-size: ${this.config.styling.headerStyle.fontSize||"14px"};\n        font-weight: ${this.config.styling.headerStyle.fontWeight||"600"};\n        color: ${this.config.styling.headerStyle.color||"#ffffff"};\n        border-right: 1px solid rgba(255,255,255,0.1);\n        display: flex;\n        align-items: center;\n        justify-content: ${"right"===e.style?.textAlign?"flex-end":"center"===e.style?.textAlign?"center":"flex-start"};\n      `,e.style&&Object.assign(t.style,e.style),this.config.options.sortable&&!1!==e.sortable&&(t.style.cursor="pointer",t.style.userSelect="none",t.dataset.columnId=e.id,t.innerHTML+=' <span class="sort-indicator">⚌</span>'),this.headerContainer.appendChild(t),this.columnsMap.set(e.id,e)}))}createBody(){this.config.rows.forEach(((e,t)=>{const n=this.createRow(e,t);this.bodyContainer.appendChild(n)}))}createRow(e,t){const n=document.createElement("div");return n.id=e.id||`row-${t}`,n.className="table-row",n.style.cssText=`\n      display: flex;\n      min-height: ${this.config.styling.rowHeight||40}px;\n      border-bottom: 1px solid #e9ecef;\n      ${t%2==1?`background-color: ${this.config.styling.alternateRowStyle?.backgroundColor||"#f8f9fa"};`:""}\n    `,e.style&&Object.assign(n.style,e.style),this.config.columns.forEach((i=>{const o=this.createCell(e,i,t);n.appendChild(o)})),this.rowsMap.set(n.id,e),n}createCell(e,t,n){const i=document.createElement("div"),o=e.cells[t.id];return i.style.cssText=`\n      width: ${t.width||100}px;\n      min-width: ${t.width||100}px;\n      max-width: ${t.width||100}px;\n      padding: ${this.config.styling.cellStyle.padding||"8px 12px"};\n      display: flex;\n      align-items: center;\n      font-size: ${this.config.styling.cellStyle.fontSize||"13px"};\n      color: ${this.config.styling.cellStyle.color||"#212529"};\n      background-color: ${this.config.styling.cellStyle.backgroundColor||"#ffffff"};\n      border-right: 1px solid #e9ecef;\n      justify-content: ${"right"===t.style?.textAlign?"flex-end":"center"===t.style?.textAlign?"center":"flex-start"};\n    `,o&&(i.id=o.id||`cell-${n}-${t.id}`,i.textContent=o.content||"",o.style&&Object.assign(i.style,o.style),this.cellsMap.set(i.id,{...o,rowId:e.id||`row-${n}`,columnId:t.id})),i.dataset.rowId=e.id||`row-${n}`,i.dataset.columnId=t.id,i.className="table-cell",i}setupEventListeners(){this.headerContainer.addEventListener("click",(e=>{e.target.classList.contains("table-header-cell")&&e.target.dataset.columnId&&this.handleHeaderClick(e.target,e)})),this.bodyContainer.addEventListener("click",(e=>{e.target.classList.contains("table-cell")&&this.handleCellClick(e.target,e)})),this.bodyContainer.addEventListener("mouseover",(e=>{e.target.classList.contains("table-cell")&&this.handleCellHover(e.target)})),this.bodyContainer.addEventListener("mouseout",(e=>{e.target.classList.contains("table-cell")&&this.handleCellLeave(e.target)}))}handleCellClick(e,t){const n=this.cellsMap.get(e.id),i=e.dataset.rowId,o=e.dataset.columnId;this.config.options.selectable&&this.toggleCellSelection(e.id),this.callbacks.onCellClick&&this.callbacks.onCellClick(n,i,o,t)}handleHeaderClick(e,t){const n=e.dataset.columnId;this.config.options.sortable&&this.sortByColumn(n)}handleCellHover(e){const t=e.parentElement;t&&this.config.styling.states.hover&&Object.assign(t.style,this.config.styling.states.hover)}handleCellLeave(e){const t=e.parentElement;if(t){const e=t.id,n=this.rowsMap.get(e),i=Array.from(this.bodyContainer.children).indexOf(t);t.style.cssText=`\n        display: flex;\n        min-height: ${this.config.styling.rowHeight||40}px;\n        border-bottom: 1px solid #e9ecef;\n        ${i%2==1?`background-color: ${this.config.styling.alternateRowStyle?.backgroundColor||"#f8f9fa"};`:""}\n      `,n&&n.style&&Object.assign(t.style,n.style)}}addRow(e){const t=this.config.rows.length;this.config.rows.push(e);const n=this.createRow(e,t);return this.bodyContainer.appendChild(n),this.callbacks.onRowAdd&&this.callbacks.onRowAdd(e),e.id||`row-${t}`}removeRow(e){const t=document.getElementById(e);t&&(t.remove(),this.rowsMap.delete(e),this.selectedRows.delete(e),this.callbacks.onRowDelete&&this.callbacks.onRowDelete(e))}updateCell(e,t,n){const i=`cell-${e.split("-")[1]}-${t}`,o=document.getElementById(i),s=this.cellsMap.get(i);o&&s&&(o.textContent=n,s.content=n,this.callbacks.onCellEdit&&this.callbacks.onCellEdit(s,n))}sortByColumn(e){const t=this.sortConfig.column===e&&"asc"===this.sortConfig.direction?"desc":"asc";this.sortConfig={column:e,direction:t},this.config.rows.sort(((n,i)=>{const o=n.cells[e]?.content||"",s=i.cells[e]?.content||"",r=o.localeCompare(s,void 0,{numeric:!0});return"asc"===t?r:-r})),this.refreshTable(),this.updateSortIndicators(e,t),this.callbacks.onSort&&this.callbacks.onSort(e,t)}toggleCellSelection(e){const t=document.getElementById(e);this.selectedCells.has(e)?(this.selectedCells.delete(e),this.handleCellLeave(t)):(this.config.options.multiSelect||this.clearSelection(),this.selectedCells.add(e),Object.assign(t.style,this.config.styling.states.selected))}clearSelection(){this.selectedCells.forEach((e=>{const t=document.getElementById(e);t&&this.handleCellLeave(t)})),this.selectedCells.clear()}refreshTable(){this.bodyContainer.innerHTML="",this.config.rows.forEach(((e,t)=>{const n=this.createRow(e,t);this.bodyContainer.appendChild(n)}))}updateSortIndicators(e,t){this.config.columns.forEach((n=>{const i=document.getElementById(`header-${n.id}`);if(i){const o=i.querySelector(".sort-indicator");o&&(o.textContent=n.id===e?"asc"===t?"▲":"▼":"⚌")}}))}exportToCSV(){let e="";return e+=this.config.columns.map((e=>e.header||e.id)).join(",")+"\n",this.config.rows.forEach((t=>{const n=this.config.columns.map((e=>{const n=t.cells[e.id];return n?`"${n.content}"`:""}));e+=n.join(",")+"\n"})),e}destroy(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.cellsMap.clear(),this.rowsMap.clear(),this.columnsMap.clear(),this.selectedRows.clear(),this.selectedCells.clear(),this.isInitialized=!1}}});d("tooltip-container",{tag:"div",class:"hs-tooltip",css:{position:"absolute",backgroundColor:"#333",color:"white",padding:"8px 12px",borderRadius:"4px",fontSize:"14px",zIndex:"9999",pointerEvents:"none",opacity:"0",transition:"opacity 0.2s ease"}});var ee={create:(e={})=>{const{text:t="Tooltip",target:n,position:i="top",css:o={},...s}=e,r=c("tooltip-container",{text:t,css:{...o},...s});return n&&(n.addEventListener("mouseenter",(()=>{r.style.opacity="1",document.body.appendChild(r);const e=n.getBoundingClientRect();r.style.left=e.left+e.width/2-r.offsetWidth/2+"px",r.style.top=e.top-r.offsetHeight-8+"px"})),n.addEventListener("mouseleave",(()=>{r.style.opacity="0",setTimeout((()=>{r.parentNode&&r.parentNode.removeChild(r)}),200)}))),r}},te=Object.freeze({__proto__:null,default:ee});const ne=new class{constructor(){this.units=new Map,this.connections=new Map,this.selectedUnits=new Set,this.dragState=null,this.connectionMode=!1,this.firstConnector=null,this.nextUnitId=1,this.nextConnectorId=1,this.nextConnectionId=1,this.connectorDragState={isDragging:!1,sourceConnector:null,dragLine:null},this.setupGlobalListeners()}setupGlobalListeners(){document.addEventListener("click",(e=>{e.target.closest(".unit-container")||e.target.closest(".unit-connector")||this.deselectAll()}))}generateUnitId(){return"unit_"+this.nextUnitId++}generateConnectorId(){return"connector_"+this.nextConnectorId++}generateConnectionId(){return"connection_"+this.nextConnectionId++}registerUnit(e){this.units.set(e.id,e)}unregisterUnit(e){this.removeAllConnectionsForUnit(e),this.units.delete(e),this.selectedUnits.delete(e)}removeAllConnectionsForUnit(e){const t=[];this.connections.forEach(((n,i)=>{n.fromUnit!==e&&n.toUnit!==e||t.push(i)})),t.forEach((e=>this.removeConnection(e)))}selectUnit(e){this.selectedUnits.add(e);const t=this.units.get(e);t&&t.element.classList.add("unit-selected")}deselectUnit(e){this.selectedUnits.delete(e);const t=this.units.get(e);t&&t.element.classList.remove("unit-selected")}deselectAll(){this.selectedUnits.forEach((e=>this.deselectUnit(e)))}getSelectedUnits(){return Array.from(this.selectedUnits)}createConnection(e,t,n,i){const o=this.generateConnectionId(),s={id:o,fromUnit:e,fromConnector:t,toUnit:n,toConnector:i};return this.connections.set(o,s),this.renderConnection(s),o}removeConnection(e){if(this.connections.get(e)){const t=document.querySelector(`[data-connection-id="${e}"]`);t&&t.remove(),this.connections.delete(e)}}renderConnection(e){const t=this.units.get(e.fromUnit),n=this.units.get(e.toUnit);if(!t||!n)return;const i=t.element.querySelector(`[data-connector-id="${e.fromConnector}"]`),o=n.element.querySelector(`[data-connector-id="${e.toConnector}"]`);if(!i||!o)return;const s=document.createElementNS("http://www.w3.org/2000/svg","line");s.setAttribute("data-connection-id",e.id),s.classList.add("unit-connection-line"),this.updateConnectionPosition(s,i,o);let r=document.querySelector(".unit-connections-svg");r||(r=document.createElementNS("http://www.w3.org/2000/svg","svg"),r.classList.add("unit-connections-svg"),r.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        pointer-events: none;\n        z-index: 50;\n      ",document.body.appendChild(r)),r.appendChild(s)}updateConnectionPosition(e,t,n){const i=t.getBoundingClientRect(),o=n.getBoundingClientRect(),s=i.left+i.width/2,r=i.top+i.height/2,a=o.left+o.width/2,l=o.top+o.height/2;e.setAttribute("x1",s),e.setAttribute("y1",r),e.setAttribute("x2",a),e.setAttribute("y2",l),e.setAttribute("stroke","#666"),e.setAttribute("stroke-width","2")}updateAllConnections(){this.connections.forEach((e=>{const t=document.querySelector(`[data-connection-id="${e.id}"]`);if(t){const n=this.units.get(e.fromUnit),i=this.units.get(e.toUnit);if(n&&i){const o=n.element.querySelector(`[data-connector-id="${e.fromConnector}"]`),s=i.element.querySelector(`[data-connector-id="${e.toConnector}"]`);o&&s&&this.updateConnectionPosition(t,o,s)}}}))}getAllConnections(){return Array.from(this.connections.values())}handleConnectorClick(e,t,n){if(this.firstConnector){const{unitId:i,connectorId:o,connectorType:s}=this.firstConnector;if((i!==e||o!==t)&&("input"===s&&"output"===n||"output"===s&&"input"===n)){let n,r,a,l;"output"===s?(n=i,r=o,a=e,l=t):(n=e,r=t,a=i,l=o);const c=Array.from(this.connections.values()).find((e=>e.fromUnit===n&&e.fromConnector===r&&e.toUnit===a&&e.toConnector===l));c?this.removeConnection(c.id):this.createConnection(n,r,a,l)}this.highlightConnector(i,o,!1),this.firstConnector=null}else this.firstConnector={unitId:e,connectorId:t,connectorType:n},this.highlightConnector(e,t,!0)}highlightConnector(e,t,n){const i=this.units.get(e);if(i){const e=i.element.querySelector(`[data-connector-id="${t}"]`);e&&(n?e.classList.add("connector-selected"):e.classList.remove("connector-selected"))}}startConnectorDrag(e,t,n,i){i.preventDefault(),i.stopPropagation(),this.connectorDragState.isDragging=!0,this.connectorDragState.sourceConnector={unitId:e,connectorId:t,connectorType:n},this.createDragLine(i),document.addEventListener("mousemove",this.handleConnectorDragMove.bind(this)),document.addEventListener("mouseup",this.handleConnectorDragEnd.bind(this))}createDragLine(e){let t=document.querySelector(".unit-connections-svg");t||(t=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.classList.add("unit-connections-svg"),t.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        pointer-events: none;\n        z-index: 50;\n      ",document.body.appendChild(t));const n=document.createElementNS("http://www.w3.org/2000/svg","line");n.classList.add("unit-drag-line"),n.setAttribute("stroke","#007bff"),n.setAttribute("stroke-width","2"),n.setAttribute("stroke-dasharray","5,5"),n.setAttribute("opacity","0.8");const i=this.getConnectorElement(this.connectorDragState.sourceConnector.unitId,this.connectorDragState.sourceConnector.connectorId);if(i){const t=i.getBoundingClientRect(),o=t.left+t.width/2,s=t.top+t.height/2;n.setAttribute("x1",o),n.setAttribute("y1",s),n.setAttribute("x2",e.clientX),n.setAttribute("y2",e.clientY)}t.appendChild(n),this.connectorDragState.dragLine=n}handleConnectorDragMove(e){if(!this.connectorDragState.isDragging||!this.connectorDragState.dragLine)return;this.connectorDragState.dragLine.setAttribute("x2",e.clientX),this.connectorDragState.dragLine.setAttribute("y2",e.clientY);const t=document.elementFromPoint(e.clientX,e.clientY);if(t&&t.classList.contains("unit-connector")){t.getAttribute("data-connector-id");const e=t.getAttribute("data-connector-type");t.closest(".unit-container").getAttribute("data-unit-id");const n=this.connectorDragState.sourceConnector.connectorType;("output"===n&&"input"===e||"input"===n&&"output"===e)&&t.classList.add("connector-drag-hover")}document.querySelectorAll(".connector-drag-hover").forEach((e=>{e.contains(t)||e.classList.remove("connector-drag-hover")}))}handleConnectorDragEnd(e){if(!this.connectorDragState.isDragging)return;this.connectorDragState.dragLine&&this.connectorDragState.dragLine.remove();const t=document.elementFromPoint(e.clientX,e.clientY);if(t&&t.classList.contains("unit-connector")){const e=t.getAttribute("data-connector-id"),n=t.getAttribute("data-connector-type"),i=t.closest(".unit-container").getAttribute("data-unit-id"),o=this.connectorDragState.sourceConnector;if("output"===o.connectorType&&"input"===n||"input"===o.connectorType&&"output"===n){let t,n,s,r;"output"===o.connectorType?(t=o.unitId,n=o.connectorId,s=i,r=e):(t=i,n=e,s=o.unitId,r=o.connectorId);const a=Array.from(this.connections.values()).find((e=>e.fromUnit===t&&e.fromConnector===n&&e.toUnit===s&&e.toConnector===r));a?this.removeConnection(a.id):this.createConnection(t,n,s,r)}}document.querySelectorAll(".connector-drag-hover").forEach((e=>{e.classList.remove("connector-drag-hover")})),document.removeEventListener("mousemove",this.handleConnectorDragMove.bind(this)),document.removeEventListener("mouseup",this.handleConnectorDragEnd.bind(this)),this.connectorDragState.isDragging=!1,this.connectorDragState.sourceConnector=null,this.connectorDragState.dragLine=null}getConnectorElement(e,t){const n=this.units.get(e);return n?n.element.querySelector(`[data-connector-id="${t}"]`):null}};d("unit-container",{tag:"div",class:"unit-container",css:{position:"absolute",minWidth:"120px",minHeight:"80px",backgroundColor:"#f8f9fa",border:"2px solid #ddd",borderRadius:"8px",cursor:"move",userSelect:"none",overflow:"visible",zIndex:"100"}}),d("unit-header",{tag:"div",class:"unit-header",css:{backgroundColor:"#e9ecef",borderBottom:"1px solid #ddd",borderRadius:"6px 6px 0 0",padding:"8px 12px",fontWeight:"bold",fontSize:"14px",color:"#333",cursor:"move"}}),d("unit-name",{tag:"span",class:"unit-name",css:{display:"block",outline:"none",backgroundColor:"transparent",border:"none"}}),d("unit-body",{tag:"div",class:"unit-body",css:{padding:"8px 12px",minHeight:"32px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}}),d("unit-icon",{tag:"img",class:"unit-icon",attrs:{draggable:"false"},css:{maxWidth:"32px",maxHeight:"32px",objectFit:"contain",pointerEvents:"none"}}),d("unit-connector",{tag:"div",class:"unit-connector",css:{zIndex:"2",position:"absolute",width:"12px",height:"12px",backgroundColor:"#007bff",borderRadius:"50%",cursor:"pointer",border:"2px solid #fff",boxShadow:"0 0 0 1px #007bff"}}),d("unit-connector-input",{tag:"div",class:"unit-connector unit-connector-input",css:{position:"absolute",width:"12px",height:"12px",borderRadius:"50%",cursor:"pointer",border:"2px solid #fff",left:"-8px",backgroundColor:"#28a745",boxShadow:"0 0 0 1px #28a745"}}),d("unit-connector-output",{tag:"div",class:"unit-connector unit-connector-output",css:{position:"absolute",width:"12px",height:"12px",borderRadius:"50%",cursor:"pointer",border:"2px solid #fff",right:"-8px",backgroundColor:"#dc3545",boxShadow:"0 0 0 1px #dc3545"}});if(!document.querySelector("#unit-styles")){const e=document.createElement("style");e.id="unit-styles",e.textContent='\n  .unit-selected {\n    border-color: #007bff !important;\n    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25) !important;\n  }\n  \n  .unit-name[contenteditable="true"] {\n    background-color: rgba(255, 255, 255, 0.9) !important;\n    border: none !important;\n    border-radius: 3px !important;\n    padding: 0 !important;\n    outline: none !important;\n    box-shadow: inset 0 0 0 1px rgba(0, 123, 255, 0.3) !important;\n  }\n  \n  .connector-selected {\n    transform: scale(1.3) !important;\n    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.4) !important;\n  }\n  \n  .unit-connector:hover {\n    transform: scale(1.2);\n  }\n  \n  .connector-drag-hover {\n    transform: scale(1.4) !important;\n    box-shadow: 0 0 0 4px rgba(40, 167, 69, 0.6) !important;\n  }\n  \n  .unit-icon.animated {\n    animation: iconPulse 0.3s ease;\n  }\n  \n  @keyframes iconPulse {\n    0% { transform: scale(1); }\n    50% { transform: scale(1.1); }\n    100% { transform: scale(1); }\n  }\n',document.head.appendChild(e)}class ie{constructor(e={}){const{id:t=ne.generateUnitId(),name:n="Unit",position:i={x:100,y:100},inputs:o=[],outputs:s=[],icon:r=null,iconSrc:a=null,backgroundColor:l=null}=e;this.id=t,this.name=n,this.position=i,this.inputs=[],this.outputs=[],this.isDragging=!1,this.dragOffset={x:0,y:0},this.isEditingName=!1,this.backgroundColor=l,this.createElement(),this.setupDragging(),this.setupSelection(),this.setupNameEditing(),this.setPosition(i.x,i.y),l&&this.setBackgroundColor(l),ne.registerUnit(this),document.body.appendChild(this.element),o.forEach((e=>this.addInput(e))),s.forEach((e=>this.addOutput(e))),this.adjustModuleHeight(),(r||a)&&this.setIcon(r||a)}createElement(){this.element=c("unit-container",{attrs:{"data-unit-id":this.id}}),this.header=c("unit-header"),this.nameElement=c("unit-name",{text:this.name}),this.body=c("unit-body"),this.header.appendChild(this.nameElement),this.element.appendChild(this.header),this.element.appendChild(this.body)}setupDragging(){let e,t,n,i;const o=o=>{if(!this.isDragging)return;const s=o.clientX-e,r=o.clientY-t;this.setPosition(n+s,i+r),ne.updateAllConnections()},s=()=>{this.isDragging=!1,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",s)};this.header.addEventListener("mousedown",(r=>{this.isEditingName||(this.isDragging=!0,e=r.clientX,t=r.clientY,n=this.position.x,i=this.position.y,document.addEventListener("mousemove",o),document.addEventListener("mouseup",s),r.preventDefault())}))}setupSelection(){this.element.addEventListener("click",(e=>{e.stopPropagation(),e.ctrlKey||e.metaKey?ne.selectedUnits.has(this.id)?ne.deselectUnit(this.id):ne.selectUnit(this.id):(ne.deselectAll(),ne.selectUnit(this.id))}))}setupNameEditing(){this.nameElement.addEventListener("dblclick",(e=>{e.stopPropagation(),this.startNameEditing()}))}startNameEditing(){this.isEditingName=!0,this.nameElement.contentEditable=!0,this.nameElement.focus();const e=document.createRange();e.selectNodeContents(this.nameElement);const t=window.getSelection();t.removeAllRanges(),t.addRange(e);this.nameElement.addEventListener("blur",(()=>{this.isEditingName=!1,this.nameElement.contentEditable=!1,this.name=this.nameElement.textContent.trim()||"Unit",this.nameElement.textContent=this.name}),{once:!0}),this.nameElement.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),this.nameElement.blur())}))}setPosition(e,t){this.position.x=e,this.position.y=t,this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}setBackgroundColor(e){this.backgroundColor=e,this.element&&(this.element.style.backgroundColor=e)}setIcon(e){const t=this.body.querySelector(".unit-icon");if(t&&t.remove(),!e)return;const n=c("unit-icon");n.draggable=!1,e.startsWith("data:"),n.src=e,this.body.appendChild(n),this.iconElement=n}animateIcon(){this.iconElement&&(this.iconElement.classList.add("animated"),setTimeout((()=>{this.iconElement.classList.remove("animated")}),300))}addInput(e={}){const{id:t=ne.generateConnectorId(),name:n=`Input ${this.inputs.length+1}`,color:i="#28a745"}=e,o=c("unit-connector-input",{attrs:{"data-connector-id":t,"data-connector-type":"input",title:n}});i&&(o.style.backgroundColor=i,o.style.boxShadow=`0 0 0 1px ${i}`);const s=this.inputs.length;return o.style.top=49+20*s+"px",o.addEventListener("click",(e=>{e.stopPropagation(),ne.handleConnectorClick(this.id,t,"input")})),o.addEventListener("mousedown",(e=>{e.stopPropagation(),ne.startConnectorDrag(this.id,t,"input",e)})),this.element.appendChild(o),this.inputs.push({id:t,name:n,color:i,element:o}),this.adjustModuleHeight(),t}addOutput(e={}){const{id:t=ne.generateConnectorId(),name:n=`Output ${this.outputs.length+1}`,color:i="#dc3545"}=e,o=c("unit-connector-output",{attrs:{"data-connector-id":t,"data-connector-type":"output",title:n}});i&&(o.style.backgroundColor=i,o.style.boxShadow=`0 0 0 1px ${i}`);const s=this.outputs.length;return o.style.top=49+20*s+"px",o.addEventListener("click",(e=>{e.stopPropagation(),ne.handleConnectorClick(this.id,t,"output")})),o.addEventListener("mousedown",(e=>{e.stopPropagation(),ne.startConnectorDrag(this.id,t,"output",e)})),this.element.appendChild(o),this.outputs.push({id:t,name:n,color:i,element:o}),this.adjustModuleHeight(),t}removeInput(e){const t=this.inputs.findIndex((t=>t.id===e));if(-1!==t){this.inputs[t].element.remove(),this.inputs.splice(t,1),this.repositionInputs()}}removeOutput(e){const t=this.outputs.findIndex((t=>t.id===e));if(-1!==t){this.outputs[t].element.remove(),this.outputs.splice(t,1),this.repositionOutputs()}}repositionInputs(){this.inputs.forEach(((e,t)=>{e.element.style.top=49+20*t+"px"})),this.adjustModuleHeight()}repositionOutputs(){this.outputs.forEach(((e,t)=>{e.element.style.top=49+20*t+"px"})),this.adjustModuleHeight()}adjustModuleHeight(){const e=Math.max(this.inputs.length,this.outputs.length);if(0===e)return this.element.style.height="auto",void(this.element.style.minHeight="60px");const t=20*Math.max(1,e),n=35+Math.max(32,t)+16+8;this.element.style.height=`${n}px`,this.element.style.minHeight=`${n}px`,console.log(`📏 Unit ${this.name}: ${e} connecteurs max → hauteur ${n}px`)}select(){ne.selectUnit(this.id)}deselect(){ne.deselectUnit(this.id)}rename(e){this.name=e,this.nameElement.textContent=e}destroy(){ne.unregisterUnit(this.id),this.element.remove()}onClick(){this.animateIcon()}onLongClick(){this.animateIcon()}}function oe(e){return new ie(e)}function se(e){const t=ne.units.get(e);t&&t.destroy()}function re(e){ne.selectUnit(e)}function ae(e){ne.deselectUnit(e)}function le(e,t){const n=ne.units.get(e);n&&n.rename(t)}var ce={create:oe},de=Object.freeze({__proto__:null,connectUnits:function(e,t,n,i){return ne.createConnection(e,t,n,i)},createUnit:oe,default:ce,deleteUnit:se,deleteUnits:function(e){e.forEach((e=>se(e)))},deselectAllUnits:function(){ne.deselectAll()},deselectUnit:ae,deselectUnits:function(e){e.forEach((e=>ae(e)))},disconnectUnits:function(e,t,n,i){const o=Array.from(ne.connections.values()).find((o=>o.fromUnit===e&&o.fromConnector===t&&o.toUnit===n&&o.toConnector===i));o&&ne.removeConnection(o.id)},getAllConnections:function(){return ne.getAllConnections()},getAllUnits:function(){return Array.from(ne.units.values())},getSelectedUnits:function(){return ne.getSelectedUnits()},getUnit:function(e){return ne.units.get(e)},renameUnit:le,renameUnits:function(e,t){e.forEach((e=>le(e,t)))},selectUnit:re,selectUnits:function(e){e.forEach((e=>re(e)))},unitManager:ne});let he=null;function pe(){const e={ListBuilder:g,BadgeBuilder:b,ButtonBuilder:z,DraggableBuilder:j,MatrixBuilder:_,MenuBuilder:H,SliderBuilder:G,TableBuilder:Q,TooltipBuilder:te,UnitBuilder:de};return Object.entries(e).forEach((([e,t])=>{try{if(t.default&&t.default.create){const n=e.replace("Builder","");window[n]=t.default.create,window[`${n}Styles`]=t.default,"Draggable"===n&&(window.draggable=t.default.create,window.makeDraggable=t.default.makeDraggable,window.makeDraggableWithDrop=t.default.makeDraggableWithDrop,window.makeDropZone=t.default.makeDropZone),he.loadedPlugins.add(n)}}catch(t){console.warn(`⚠️ Erreur lors de l'exposition de ${e}:`,t.message)}})),window.loadPlugin=async e=>window[e],e}function ue(){!function(){window.$=c,window.define=d,window.observeMutations=h,window.body=document.body,window.toKebabCase=e=>e.replace(/([A-Z])/g,"-$1").toLowerCase(),he=new p,window.pluginManager=he;const e=new u(he);window.Squirrel=e}(),pe(),window.squirrelReady=!0}function ge(){try{define("view",{tag:"div",class:"atome",id:"view"}),$("view",{parent:document.body,css:{background:"#272727",color:"lightgray",left:"0px",top:"0px",position:"absolute",width:"100%",height:"100%",overflow:"auto"}}),window.squirrelDomReady=!0,window.dispatchEvent(new CustomEvent("squirrel:ready",{detail:{version:"1.0.0",components:Array.from(he.loadedPlugins),domReady:!0}}))}catch(e){console.error("❌ Erreur lors de l'initialisation DOM:",e)}}window.squirrelReady=!1,window.squirrelDomReady=!1,window.whenSquirrelReady=function(e){window.squirrelReady?e():setTimeout(e,0)},window.whenSquirrelDOMReady=function(e){window.squirrelDomReady?e():window.addEventListener("squirrel:ready",e,{once:!0})},"undefined"!=typeof window&&(ue(),document.body?ge():"loading"===document.readyState?document.addEventListener("DOMContentLoaded",ge):setTimeout(ge,0));var me={initAPIs:ue,initDOM:ge,loadComponents:pe};e.default=me,e.initSquirrelAPIs=ue,e.initSquirrelDOM=ge,e.loadComponents=pe,Object.defineProperty(e,"__esModule",{value:!0})}));

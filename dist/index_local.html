<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Complet - Squirrel.js Sans Attente</title>
</head>

<body>
  <script src="./squirrel.js"></script>
  <script>
    console.log('ğŸ¯ Test dÃ©marrÃ© - vÃ©rification des APIs...');
    
    // Test 1: APIs disponibles
    console.log('âœ… $ disponible:', typeof $ !== 'undefined');
    console.log('âœ… grab disponible:', typeof grab !== 'undefined');
    console.log('âœ… puts disponible:', typeof puts !== 'undefined');
    console.log('âœ… makeDraggable disponible:', typeof makeDraggable !== 'undefined');
    
    // Test 2: DOM ready states
    console.log('âœ… squirrelReady:', window.squirrelReady);
    console.log('âœ… squirrelDomReady:', window.squirrelDomReady);
    console.log('âœ… #view existe:', !!document.getElementById('view'));

    // Test 3: CrÃ©ation d'Ã©lÃ©ments avec parent: '#view'
    const monSpan = $('span', {
      id: 'test1',
      parent: '#view',
      css: {
        backgroundColor: '#00f',
        display: 'block',
        position: 'absolute',
        marginLeft: '0',
        padding: '10px',
        color: 'white',
        margin: '10px',
        borderRadius: '5px'
      },
      text: 'Je suis un SPAN sans attente ! ğŸ¯'
    });

    // Test 4: grab() fonctionne immÃ©diatement
    const element = grab('test1');
    console.log('âœ… grab(test1) retourne:', element);
    console.log('âœ… Ã‰lÃ©ment dans le DOM:', element && element.parentNode);

    // Test 5: makeDraggable fonctionne
    if (element && typeof makeDraggable !== 'undefined') {
      makeDraggable(element, {
        onDragStart: (el, event) => { 
          puts(`ğŸ¯ Drag started sur ${el.id}!`); 
        }
      });
      console.log('âœ… Draggable configurÃ©');
    }

    // Test 6: Manipulation directe
    if (element) {
      element.left = '100px';
      element.style.top = '100px';
      console.log('âœ… Position modifiÃ©e');
    }

    // Test 7: CrÃ©er un deuxiÃ¨me Ã©lÃ©ment pour tester
    const button = $('button', {
      id: 'test-button',
      parent: '#view',
      text: 'Cliquez-moi !',
      css: {
        position: 'absolute',
        top: '200px',
        left: '20px',
        padding: '10px',
        backgroundColor: '#007acc',
        color: 'white',
        border: 'none',
        borderRadius: '5px',
        cursor: 'pointer'
      },
      onclick: () => {
        puts('ğŸ‰ Button cliquÃ© sans problÃ¨me !');
        alert('Tout fonctionne parfaitement !');
      }
    });

    console.log('ğŸ‰ Test terminÃ© - Tout fonctionne sans attendre d\'Ã©vÃ©nement !');
  </script>
</body>

</html>
